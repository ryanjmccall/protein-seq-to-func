{
  "pmcid": "PMC8454663",
  "doi": "10.1016/j.xinn.2021.100141",
  "title": "clusterProfiler 4.0: A universal enrichment tool for interpreting omics data.",
  "year": 2021,
  "journal": "",
  "protein_hits": [
    "OCT4"
  ],
  "xml": "<!DOCTYPE article PUBLIC \"-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN\" \"JATS-archivearticle1-3-mathml3.dtd\"> \n<article xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:mml=\"http://www.w3.org/1998/Math/MathML\" article-type=\"research-article\" dtd-version=\"1.3\"><?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName art560.dtd?><?SourceDTD.Version 5.6.0?><?ConverterInfo.XSLTName elsevier2nlmx2.xsl?><?ConverterInfo.Version 1?><?origin publisher?><?FILEmeta_XINN100141 xml ?><?FILEmain xml ?><?FILEmain pdf ?><?FILEgr1 jpg ?><?FILEgr2 jpg ?><?FILEgr3 jpg ?><?FILEgr4 jpg ?><?FILEgr5 jpg ?><?FILEgr6 jpg ?><?FILEfx1 jpg ?><?FILEmmc1 pdf ?><?FILEmmc2 pdf ?><?properties open_access?><processing-meta base-tagset=\"archiving\" mathml-version=\"3.0\" table-model=\"xhtml\" tagset-family=\"jats\"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type=\"nlm-ta\">Innovation (Camb)</journal-id><journal-id journal-id-type=\"iso-abbrev\">Innovation (Camb)</journal-id><journal-title-group><journal-title>The Innovation</journal-title></journal-title-group><issn pub-type=\"epub\">2666-6758</issn><publisher><publisher-name>Elsevier</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type=\"pmcid\">8454663</article-id><article-id pub-id-type=\"pii\">S2666-6758(21)00066-7</article-id><article-id pub-id-type=\"doi\">10.1016/j.xinn.2021.100141</article-id><article-id pub-id-type=\"publisher-id\">100141</article-id><article-categories><subj-group subj-group-type=\"heading\"><subject>Article</subject></subj-group></article-categories><title-group><article-title>clusterProfiler 4.0: A universal enrichment tool for interpreting omics data</article-title></title-group><contrib-group><contrib contrib-type=\"author\" id=\"au1\"><name><surname>Wu</surname><given-names>Tianzhi</given-names></name><xref rid=\"aff1\" ref-type=\"aff\">1</xref><xref rid=\"fn1\" ref-type=\"fn\">5</xref></contrib><contrib contrib-type=\"author\" id=\"au2\"><name><surname>Hu</surname><given-names>Erqiang</given-names></name><xref rid=\"aff1\" ref-type=\"aff\">1</xref><xref rid=\"fn1\" ref-type=\"fn\">5</xref></contrib><contrib contrib-type=\"author\" id=\"au3\"><name><surname>Xu</surname><given-names>Shuangbin</given-names></name><xref rid=\"aff1\" ref-type=\"aff\">1</xref></contrib><contrib contrib-type=\"author\" id=\"au4\"><name><surname>Chen</surname><given-names>Meijun</given-names></name><xref rid=\"aff1\" ref-type=\"aff\">1</xref></contrib><contrib contrib-type=\"author\" id=\"au5\"><name><surname>Guo</surname><given-names>Pingfan</given-names></name><xref rid=\"aff1\" ref-type=\"aff\">1</xref></contrib><contrib contrib-type=\"author\" id=\"au6\"><name><surname>Dai</surname><given-names>Zehan</given-names></name><xref rid=\"aff1\" ref-type=\"aff\">1</xref></contrib><contrib contrib-type=\"author\" id=\"au7\"><name><surname>Feng</surname><given-names>Tingze</given-names></name><xref rid=\"aff1\" ref-type=\"aff\">1</xref></contrib><contrib contrib-type=\"author\" id=\"au8\"><name><surname>Zhou</surname><given-names>Lang</given-names></name><xref rid=\"aff1\" ref-type=\"aff\">1</xref></contrib><contrib contrib-type=\"author\" id=\"au9\"><name><surname>Tang</surname><given-names>Wenli</given-names></name><xref rid=\"aff1\" ref-type=\"aff\">1</xref></contrib><contrib contrib-type=\"author\" id=\"au10\"><name><surname>Zhan</surname><given-names>Li</given-names></name><xref rid=\"aff1\" ref-type=\"aff\">1</xref></contrib><contrib contrib-type=\"author\" id=\"au11\"><name><surname>Fu</surname><given-names>Xiaocong</given-names></name><xref rid=\"aff1\" ref-type=\"aff\">1</xref></contrib><contrib contrib-type=\"author\" id=\"au12\"><name><surname>Liu</surname><given-names>Shanshan</given-names></name><xref rid=\"aff1\" ref-type=\"aff\">1</xref></contrib><contrib contrib-type=\"author\" id=\"au13\"><name><surname>Bo</surname><given-names>Xiaochen</given-names></name><email>boxc@bmi.ac.cn</email><xref rid=\"aff2\" ref-type=\"aff\">2</xref><xref rid=\"cor1\" ref-type=\"corresp\">&#x02217;</xref></contrib><contrib contrib-type=\"author\" id=\"au14\"><name><surname>Yu</surname><given-names>Guangchuang</given-names></name><email>gcyu1@smu.edu.cn</email><xref rid=\"aff1\" ref-type=\"aff\">1</xref><xref rid=\"aff3\" ref-type=\"aff\">3</xref><xref rid=\"aff4\" ref-type=\"aff\">4</xref><xref rid=\"cor2\" ref-type=\"corresp\">&#x02217;&#x02217;</xref></contrib><aff id=\"aff1\"><label>1</label>Department of Bioinformatics, School of Basic Medical Sciences, Southern Medical University, Guangzhou 510515, China</aff><aff id=\"aff2\"><label>2</label>Department of Biotechnology, Beijing Institute of Radiation Medicine, Beijing 100850, China</aff><aff id=\"aff3\"><label>3</label>Guangdong Provincial Key Laboratory of Proteomics, School of Basic Medical Sciences, Southern Medical University, Guangzhou 510515, China</aff><aff id=\"aff4\"><label>4</label>Microbiome Medicine Center, Department of Laboratory Medicine, Zhujiang Hospital, Southern Medical University, Guangzhou 510515, China</aff></contrib-group><author-notes><corresp id=\"cor1\"><label>&#x02217;</label>Corresponding author <email>boxc@bmi.ac.cn</email></corresp><corresp id=\"cor2\"><label>&#x02217;&#x02217;</label>Corresponding author <email>gcyu1@smu.edu.cn</email></corresp><fn id=\"fn1\"><label>5</label><p id=\"ntpara0010\">These authors contributed equally</p></fn></author-notes><pub-date pub-type=\"pmc-release\"><day>01</day><month>7</month><year>2021</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on <pub-date\n\t\t\t\t\t\tpub-type=\"epub\">.--><pub-date pub-type=\"collection\"><day>28</day><month>8</month><year>2021</year></pub-date><pub-date pub-type=\"epub\"><day>01</day><month>7</month><year>2021</year></pub-date><volume>2</volume><issue>3</issue><elocation-id>100141</elocation-id><history><date date-type=\"received\"><day>8</day><month>5</month><year>2021</year></date><date date-type=\"accepted\"><day>29</day><month>6</month><year>2021</year></date></history><permissions><copyright-statement>&#x000a9; 2021 The Author(s)</copyright-statement><copyright-year>2021</copyright-year><license><ali:license_ref xmlns:ali=\"http://www.niso.org/schemas/ali/1.0/\" specific-use=\"textmining\" content-type=\"ccbyncndlicense\">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p></license></permissions><abstract id=\"abs0010\"><title>Summary</title><p>Functional enrichment analysis is pivotal for interpreting high-throughput omics data in life science. It is crucial for this type of tool to use the latest annotation databases for as many organisms as possible. To meet these requirements, we present here an updated version of our popular Bioconductor package, clusterProfiler 4.0. This package has been enhanced considerably compared with its original version published 9 years ago. The new version provides a universal interface for functional enrichment analysis in thousands of organisms based on internally supported ontologies and pathways as well as annotation data provided by users or derived from online databases. It also extends the <italic>dplyr</italic> and <italic>ggplot2</italic> packages to offer tidy interfaces for data operation and visualization. Other new features include gene set enrichment analysis and comparison of enrichment results from multiple gene lists. We anticipate that clusterProfiler 4.0 will be applied to a wide range of scenarios across diverse organisms.</p></abstract><abstract abstract-type=\"graphical\" id=\"abs0015\"><title>Graphical abstract</title><fig id=\"undfig1\" position=\"anchor\"><graphic xlink:href=\"fx1\"/></fig></abstract><abstract abstract-type=\"author-highlights\" id=\"abs0020\"><title>Public summary</title><p><list list-type=\"simple\" id=\"ulist0010\"><list-item id=\"u0010\"><label>&#x02022;</label><p id=\"p0010\">clusterProfiler supports exploring functional characteristics of both coding and non-coding genomics data for thousands of species with up-to-date gene annotation</p></list-item><list-item id=\"u0015\"><label>&#x02022;</label><p id=\"p0015\">It provides a universal interface for gene functional annotation from a variety of sources and thus can be applied in diverse scenarios</p></list-item><list-item id=\"u0020\"><label>&#x02022;</label><p id=\"p0020\">It provides a tidy interface to access, manipulate, and visualize enrichment results to help users achieve efficient data interpretation</p></list-item><list-item id=\"u0025\"><label>&#x02022;</label><p id=\"p0025\">Datasets obtained from multiple treatments and time points can be analyzed and compared in a single run, easily revealing functional consensus and differences among distinct conditions</p></list-item></list></p></abstract><kwd-group id=\"kwrds0010\"><title>Keywords</title><kwd>clusterProfiler</kwd><kwd>biological knowledge mining</kwd><kwd>functional analysis</kwd><kwd>enrichment analysis</kwd><kwd>visualization</kwd></kwd-group></article-meta><notes><p id=\"misc0010\">Published Online: July 1, 2021</p></notes></front><body><sec id=\"sec1\"><title>Introduction</title><p id=\"p0030\">Functional enrichment analysis is one of the most widely used techniques for interpreting gene lists or genome-wide regions of interest (ROIs)<xref rid=\"bib1\" ref-type=\"bibr\"><sup>1</sup></xref> derived from various high-throughput studies. Although many tools have been developed for gene-centric or epigenomic enrichment analysis, most are designed for model organisms or specific domains (e.g., fungi,<xref rid=\"bib2\" ref-type=\"bibr\"><sup>2</sup></xref> plants<xref rid=\"bib3\" ref-type=\"bibr\"><sup>3</sup></xref>) embedded with particular annotations such as Gene Ontology (GO) and the Kyoto Encyclopedia of Genes and Genomes (KEGG).<xref rid=\"bib4\" ref-type=\"bibr\"><sup>4</sup></xref> Non-model organisms and functional annotations other than GO and KEGG are poorly supported. Moreover, the increasing concerns for the quality of gene annotation have raised an alarm in biomedical research. Because annotation databases have diverse or irregular update periods, many tools may fail to update the corresponding information in time. A previous study<xref rid=\"bib5\" ref-type=\"bibr\"><sup>5</sup></xref> reported that about 42% of the tools were outdated by more than 5 years and that functional significance was severely underestimated, with only 26% of biological processes or pathways captured in comparison with those employing up-to-date annotation. Such negative impacts of outdated annotation can be propagated for years and&#x000a0;can hinder follow-up studies. Reanalyzing the GTEx dataset<xref rid=\"bib6\" ref-type=\"bibr\"><sup>6</sup></xref> published by the ENCODE consortium using clusterProfiler uncovered a large number&#x000a0;of new pathways, which were missed in the analysis using out-of-date annotation (<ext-link ext-link-type=\"uri\" xlink:href=\"https://github.com/GuangchuangYu/enrichment4GTEx_clusterProfiler\" id=\"intref0010\">https://github.com/GuangchuangYu/enrichment4GTEx_clusterProfiler</ext-link>), and new hypotheses were generated based on these new pathways.</p><p id=\"p0035\">The clusterProfiler library was first published in 2012<xref rid=\"bib7\" ref-type=\"bibr\"><sup>7</sup></xref> and designed to perform over-representation analysis (ORA)<xref rid=\"bib8\" ref-type=\"bibr\"><sup>8</sup></xref> using GO and KEGG for several model organisms and to compare functional profiles of various conditions on one level (e.g., different treatment groups). Since then, clusterProfiler has matured substantially and currently supports several ontology and pathway annotations, thousands of species with up-to-date gene annotation, users&#x02019; annotation data for novel species, and emerging new annotations. Both ORA and gene set enrichment analysis (GSEA)<xref rid=\"bib9\" ref-type=\"bibr\"><sup>9</sup></xref> are supported. The comparison utility is extended to support a complex experimental design that allows comparison of functional profiles of various conditions on different levels. The clusterProfiler library has many unique features, including a tidy interface that can manipulate the enrichment result and directly support the visualization of the enrichment result using <italic>ggplot2</italic> (<xref rid=\"tbl1\" ref-type=\"table\">Tables 1</xref> and <xref rid=\"mmc1\" ref-type=\"supplementary-material\">S2</xref>). Moreover, we have developed several packages to complement its functionalities, including ChIPseeker to connect functional analysis with genomic ROIs,<xref rid=\"bib10\" ref-type=\"bibr\"><sup>10</sup></xref> GOSemSim<xref rid=\"bib11\" ref-type=\"bibr\"><sup>11</sup></xref> to remove redundant GO terms, and enrichplot to visualize the enrichment results. These complementary packages enable clusterProfiler to stand out among other tools. The clusterProfiler library is one of the most popular Bioconductor packages. It has been incorporated in more than 30 CRAN and Bioconductor packages (<xref rid=\"mmc1\" ref-type=\"supplementary-material\">Table S1</xref>), several pipelines (e.g., The Cancer Genome Atlas [TCGA] Workflow<xref rid=\"bib12\" ref-type=\"bibr\"><sup>12</sup></xref> and ViralLink<xref rid=\"bib13\" ref-type=\"bibr\"><sup>13</sup></xref>), and online platforms (e.g., NASQAR<xref rid=\"bib14\" ref-type=\"bibr\"><sup>14</sup></xref> and ABioTrans<xref rid=\"bib15\" ref-type=\"bibr\"><sup>15</sup></xref>).<table-wrap position=\"float\" id=\"tbl1\"><label>Table 1</label><caption><p>Major clusterProfiler functions</p></caption><table frame=\"hsides\" rules=\"groups\"><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td>enrichGO</td><td>ORA using GO</td></tr><tr><td>enrichKEGG</td><td>ORA using KEGG pathway</td></tr><tr><td>enrichMKEGG</td><td>ORA using KEGG module</td></tr><tr><td>enrichWP</td><td>ORA using WikiPathways</td></tr><tr><td>enricher</td><td>general interface for ORA</td></tr><tr><td>gseGO</td><td>GSEA using GO</td></tr><tr><td>gseKEGG</td><td>GSEA using KEGG pathway</td></tr><tr><td>gseMKEGG</td><td>GSEA using KEGG module</td></tr><tr><td>gseWP</td><td>GSEA using WikiPathways</td></tr><tr><td>GSEA</td><td>general interface for GSEA</td></tr><tr><td>compareCluster</td><td>compare functional profiles for genes obtained from different conditions</td></tr><tr><td>merge_result</td><td>merge enrichment results for comparison</td></tr><tr><td>read.gmt</td><td>parse gene set file in GMT format</td></tr><tr><td>read.gmt.wp</td><td>parse WikiPathways GMT file</td></tr><tr><td>download_KEGG</td><td>download the latest version of the KEGG pathway/module</td></tr><tr><td>get_wp_organism</td><td>list supported organisms of WikiPathways</td></tr><tr><td>bitr</td><td>biological ID translator using OrgDb</td></tr><tr><td>bitr_kegg</td><td>biological ID translator using the KEGG database</td></tr><tr><td>setReadable</td><td>convert IDs in enrichment result to human-readable gene symbols using OrgDb</td></tr><tr><td>go2ont</td><td>convert GO ID to corresponding ontology (BP, CC, MF)</td></tr><tr><td>go2term</td><td>convert GO ID to a descriptive term</td></tr><tr><td>ko2name</td><td>convert KO ID to a descriptive name</td></tr><tr><td>buildGOmap</td><td>infer GO indirect annotation from direct annotation</td></tr><tr><td>browseKEGG</td><td>open specific KEGG pathway in a web browser with genes highlighted</td></tr><tr><td>dropGO</td><td>drop GO terms of specific level or a specific terms (mostly too general) from enrichment result</td></tr><tr><td>gofilter</td><td>restrict enrichment result at a specific GO level</td></tr><tr><td>geneInCategory</td><td>extract input genes (for ORA) or core enriched genes (for GSEA) that belong to a specific functional category</td></tr><tr><td>simplify</td><td>remove redundant GO terms from enrichment result</td></tr><tr><td>arrange</td><td>order enrichment result by the values of selected variables</td></tr><tr><td>filter</td><td>subset enrichment result that satisfies user conditions</td></tr><tr><td>group_by</td><td>group enrichment results by selected variable</td></tr><tr><td>mutate</td><td>add new variable to enrichment result</td></tr><tr><td>select</td><td>select variables in enrichment result</td></tr><tr><td>summarise</td><td>create summary statistics from enrichment result</td></tr></tbody></table></table-wrap></p></sec><sec id=\"sec2\"><title>Results</title><sec id=\"sec2.1\"><title>Gene ontology</title><p id=\"p0040\">The clusterProfiler package provides the <italic>enrichGO</italic> and <italic>gseGO</italic> functions for ORA and GSEA using GO.<xref rid=\"bib16\" ref-type=\"bibr\"><sup>16</sup></xref> Instead of providing species-specific GO annotation, clusterProfiler relies on genome-wide annotation packages (OrgDb) released by the Bioconductor project. There are 20 OrgDb packages available in Bioconductor for different species, such as human, mouse, fly, yeast, and worm. These packages are updated biannually. GO annotation for non-model organisms can be queried online via the AnnotationHub package, which provides web services for accessing genome-wide annotations from various data providers (e.g., UCSC, Ensembl, NCBI, STRING, and GENCODE). With the efforts from the Bioconductor community to maintain up-to-date GO annotation for model and non-model organisms, clusterProfiler supports GO analysis on more species compared with other tools. Moreover, a data frame of GO annotation (e.g., retrieve data from the BiomaRt or UniProt database using taxonomic ID) can be used to construct an OrgDb using the AnnotationForge package or directly through the universal interface for enrichment analysis.</p><p id=\"p0045\">GO terms are organized as a directed acyclic graph, in which a directed edge denotes a parent-child semantic relationship. A parent term might be significantly enriched only because it contains all the genes of a significantly over-represented child term. Consequently, the list of enriched GO terms is often too long and contains redundant terms, which hinders effective interpretation. Therefore, clusterProfiler integrates a <italic>simplify</italic> function to eliminate such redundant GO terms. This function employs the GOSemSim<xref rid=\"bib17\" ref-type=\"bibr\"><sup>17</sup></xref> package to calculate semantic similarities among enriched GO terms using multiple methods based on information content or graph structure. Highly similar GO terms (e.g., &#x0003e;0.7) will be removed by applying the <italic>simplify</italic> function to retain a representative term (e.g., the most significant term). The following example shows an ORA on Biological Process (BP) to identify significant BP terms associated with the differentially expressed genes (DEGs). The geneList dataset, which contains fold change of gene expression levels between breast tumor and normal samples and is provided by the DOSE package, was used in this example. The DEGs were identified by a criterion of fold change &#x0003e;2. As demonstrated in <xref rid=\"fig1\" ref-type=\"fig\">Figure&#x000a0;1</xref>A, the top 30 enriched terms are highly connected, and it seems that the DEGs are associated with a single functional module. Visualizing top enriched terms is a common approach to present and interpret the enrichment result. However, the top results are dominated by a large number of highly similar terms. After removing redundant terms, the result reveals a more global view with several different functional modules (<xref rid=\"fig1\" ref-type=\"fig\">Figure&#x000a0;1</xref>B). This feature simplifies the enrichment results, assists in interpretation, and avoids the annotation/interpretation bias.<xref rid=\"bib18\" ref-type=\"bibr\"><sup>18</sup></xref><boxed-text id=\"dtbox1\"><p id=\"p2010\"><list list-type=\"simple\" id=\"ulist0510\"><list-item id=\"u1010\"><p id=\"p2015\">library(clusterProfiler)</p></list-item><list-item id=\"u1015\"><p id=\"p2020\">data(geneList, package=\"DOSE\")</p></list-item><list-item id=\"u1020\"><p id=\"p2025\"><bold><italic>## fold change &#x0003e; 2 as DE genes</italic></bold></p></list-item><list-item id=\"u1025\"><p id=\"p2030\">de &#x0003c;- names(geneList)[abs(geneList) &#x0003e; 2]</p></list-item><list-item id=\"u1030\"><p id=\"p2035\">ego &#x0003c;- enrichGO(de, OrgDb = \"org.Hs.eg.db\", ont=\"BP\", readable=TRUE)</p></list-item><list-item id=\"u1035\"><p id=\"p2040\"><italic><bold>## use simplify to remove redundant terms</bold></italic></p></list-item><list-item id=\"u1040\"><p id=\"p2045\">ego2 &#x0003c;- simplify(ego, cutoff=0.7, by=\"p.adjust\", select_fun=min)</p></list-item></list></p></boxed-text><fig id=\"fig1\"><label>Figure&#x000a0;1</label><caption><p>Gene ontology enrichment analysis</p><p>The original result (A) and a simplified version (B) were visualized as enrichment map networks. Each node represents a gene set (i.e., a GO term) and each edge represents the overlap between two gene sets.</p></caption><graphic xlink:href=\"gr1\"/></fig></p></sec><sec id=\"sec2.2\"><title>Kyoto encyclopedia of genes and genomes</title><p id=\"p0050\">KEGG is an encyclopedia of genes and genomes.<xref rid=\"bib19\" ref-type=\"bibr\"><sup>19</sup></xref> Molecular functions are represented by networks of interactions and reactions mainly in the form of KEGG pathways and modules. A KEGG module is a collection of manually defined function units. In some situations, KEGG modules have a more straightforward interpretation. Both KEGG pathways and KEGG modules are supported by clusterProfiler. Many software tools that support KEGG analysis have stopped updating since July 2011 when KEGG initiated an academic subscription model for FTP downloading. These tools use relatively old KEGG data, and the result might be inaccurate and misleading. Fortunately, the KEGG web resource is freely available. The clusterProfiler package does not pack any KEGG data. Instead, it queries the latest online KEGG database through web API to perform functional analysis. The advantage of this feature is obvious: it allows clusterProfiler to use up-to-date data and support all the species that have KEGG annotation (more than 6,000 species are listed in <ext-link ext-link-type=\"uri\" xlink:href=\"http://www.genome.jp/kegg/catalog/org_list.html\" id=\"intref0015\">http://www.genome.jp/kegg/catalog/org_list.html</ext-link>). Moreover, clusterProfiler supports the KEGG Orthology database and can be used to perform functional characterization of the microbiomes.<xref rid=\"bib20\" ref-type=\"bibr\"><sup>20</sup></xref></p><p id=\"p0055\">In the following example, GSEA was performed with KEGG pathway. <xref rid=\"fig2\" ref-type=\"fig\">Figure&#x000a0;2</xref>A shows the plotting of GSEA enrichment results to visualize the top five perturbed pathways, i.e., the top five highest absolute values of the normalized enrichment score (NES).<xref rid=\"bib9\" ref-type=\"bibr\"><sup>9</sup></xref> The NES indicates the shift of genes belonging to a certain pathway toward either end of the ranked list and represents pathway activation or suppression. To further explore the pathway crosstalk effects, we visualized gene expression distribution of core enrichment genes using an UpSet plot (<xref rid=\"fig2\" ref-type=\"fig\">Figure&#x000a0;2</xref>B). The result shows that the expression values of genes in the intersection of cell-cycle and DNA-replication pathways are higher than those uniquely belonging to either of the two pathways. These overlapping genes are mainly minichromosome maintenance (MCM) genes, which can potentially serve as biomarkers for tumor diagnosis.<xref rid=\"bib21\" ref-type=\"bibr\"><sup>21</sup></xref> The intersection of the interleukin-17 (IL-17) signaling pathway and the proteasome pathway is only associated with one gene, interferon-&#x003b3; (IFN-&#x003b3;). The IL-17 signaling pathway induces an inflammatory response,<xref rid=\"bib22\" ref-type=\"bibr\"><sup>22</sup></xref> while IFN-&#x003b3; regulates proteasome formation.<xref rid=\"bib23\" ref-type=\"bibr\"><sup>23</sup></xref> These effects ultimately reshape the tumor microenvironment.<boxed-text id=\"dtbox2\"><p id=\"p2050\"><list list-type=\"simple\" id=\"ulist0515\"><list-item id=\"u1045\"><p id=\"p2055\">kk &#x0003c;- gseKEGG(geneList, organism = \"hsa\")</p></list-item></list></p></boxed-text><fig id=\"fig2\"><label>Figure&#x000a0;2</label><caption><p>KEGG pathway enrichment analysis</p><p>In GSEA enrichment plot (A), the curves represent the running sum of the enrichment scores, the middle part of the graph shows the position of genes that are related to certain pathways, and the bottom part of the graph displays how the metric (e.g., fold change) is distributed along with the list. The UpSet plot (B) visualizes the metric distribution of core enrichment genes. It differentiates genes that uniquely belong to a pathway or are associated with two or more pathways.</p></caption><graphic xlink:href=\"gr2\"/></fig></p></sec><sec id=\"sec2.3\"><title>Universal interface for biomedical gene sets</title><p id=\"p0060\">With the advancement of the sequencing technology, the investigation into functions for transcriptomes from non-model organisms is increasingly demanded. However, most tools in this field are designed for GO and KEGG analyses with support limited to one or several model organisms. Besides, there are increasingly more biological knowledge databases available for exploring functional characteristics from different perspectives, such as Disease Ontology,<xref rid=\"bib24\" ref-type=\"bibr\"><sup>24</sup></xref> Reactome Pathway,<xref rid=\"bib25\" ref-type=\"bibr\"><sup>25</sup></xref> Medical Subject Headings,<xref rid=\"bib26\" ref-type=\"bibr\"><sup>26</sup></xref>, and WikiPathway.<xref rid=\"bib27\" ref-type=\"bibr\"><sup>27</sup></xref> There is an urgent need for integration and support of these databases. To address these issues, clusterProfiler provides two general functions, <italic>enricher</italic> and <italic>GSEA</italic> for ORA and GSEA, with user-provided gene annotations. These two functions allow the application of all ontologies or pathways curated in diverse databases as the background in customized analyses. Therefore, users could easily import external annotations (e.g., electronic annotations using Blast2GO<xref rid=\"bib28\" ref-type=\"bibr\"><sup>28</sup></xref> and KAAS<xref rid=\"bib29\" ref-type=\"bibr\"><sup>29</sup></xref> for GO and KEGG annotations, respectively) for newly sequenced species. Moreover, it is convenient to perform functional analysis using up-to-date annotations from all popular databases, such as InterPro, Clusters of Orthologous Groups, and Mouse Phenotype Ontology, to name a few, without waiting for the updates of other tools. It would be suitable for the timely analysis of gene sets with emerging interests, such as human cell markers<xref rid=\"bib30\" ref-type=\"bibr\"><sup>30</sup></xref> and COVID-19-related gene sets.</p><p id=\"p0065\">The gene set annotation required by <italic>enricher</italic> and <italic>GSEA</italic> is a two-column data frame with one column representing gene set names (ID or descriptive name) and the other showing the corresponding genes. The gene matrix transposed (GMT) format is widely used to distribute gene set annotations. There are many gene set libraries available online (e.g., <ext-link ext-link-type=\"uri\" xlink:href=\"https://maayanlab.cloud/Enrichr/#stats\" id=\"intref0020\">https://maayanlab.cloud/Enrichr/#stats</ext-link>), including MSigDB (Molecular Signatures Database), Disease Signatures, and CCLE (Cancer Cell Line Encyclopedia). To enable the utilization of these gene sets in clusterProfiler as the background annotation to explore the underlying biological mechanisms, clusterProfiler provides a parser function, <italic>read</italic>.<italic>gmt</italic>, to import GMT files that can be directly passed to&#x000a0;the <italic>enricher</italic> and <italic>GSEA</italic> functions. In the following example, we used the <italic>GSEA</italic> function to perform gene set enrichment analysis using WikiPathways (<xref rid=\"fig5\" ref-type=\"fig\">Figure&#x000a0;5</xref>B). The annotation data were parsed by using <italic>read</italic>.<italic>gmt</italic>.<italic>wp</italic>, which is&#x000a0;a customized version of <italic>read</italic>.<italic>gmt</italic> for importing GMT files from WikiPathways.<boxed-text id=\"dtbox3\"><p id=\"p2060\"><list list-type=\"simple\" id=\"ulist0520\"><list-item id=\"u1050\"><p id=\"p2065\"><bold><italic>## downloaded from</italic></bold><ext-link ext-link-type=\"uri\" xlink:href=\"https://wikipathways-data.wmcloud.org/current/gmt/\" id=\"intref8010\"><bold><italic>https://wikipathways-data.wmcloud.org/current/gmt/</italic></bold></ext-link></p></list-item><list-item id=\"u1055\"><p id=\"p2070\">gmt &#x0003c;- &#x02018;wikipathways-20210310-gmt-Homo_sapiens.gmt&#x02019;</p></list-item><list-item id=\"u1060\"><p id=\"p2075\">wp &#x0003c;- <bold>read.gmt.wp</bold>(gmt)</p></list-item><list-item id=\"u1065\"><p id=\"p2080\">ewp &#x0003c;- <bold>GSEA</bold>(geneList, TERM2GENE=wp[,<bold>c</bold>(\"wpid\", \"gene\")], TERM2NAME=wp[,<bold>c</bold>(\"wpid\", \"name\")])</p></list-item></list></p></boxed-text></p></sec><sec id=\"sec2.4\"><title>Functional interpretation of genomic ROIs</title><p id=\"p0070\">With the increasing availability of genomic sequences, non-coding genomic regions (e.g., <italic>cis</italic>-regulatory elements, non-coding RNAs, and transposons) have posed a demanding challenge to exploration of their roles in various biological processes.<xref rid=\"bib1\" ref-type=\"bibr\"><sup>1</sup></xref> Unlike coding genes, non-coding genomic regions are typically not well functionally annotated. Analyzing biological functions of the proximal genes is a common strategy in research on the biological meaning of a set of non-coding genomic regions. Software tools, such as the Genomic Regions Enrichment of Annotations Tool (GREAT),<xref rid=\"bib31\" ref-type=\"bibr\"><sup>31</sup></xref> are implemented to follow this strategy. However, these tools only support a limited number of species. For example, GREAT is designed for human and mouse only. In addition, many tools only take the host or nearest genes into consideration but ignore long-distance regulations. Our in-house developed package, ChIPseeker,<xref rid=\"bib10\" ref-type=\"bibr\"><sup>10</sup></xref> is originally designed for chromatin immunoprecipitation (ChIP) peak annotation, comparison, and visualization and has been employed to analyze genome-wide ROIs, such as open chromatin regions obtained by DNase-seq<xref rid=\"bib32\" ref-type=\"bibr\"><sup>32</sup></xref> and ATAC-seq.<xref rid=\"bib33\" ref-type=\"bibr\"><sup>33</sup></xref> To facilitate biological interpretation of genome-wide regions, we implemented a function, <italic>seq2gene</italic>, in ChIPseeker to associate genomic regions with coding genes through many-to-many mapping. It automatically maps genomic regions to host genes (either located in exon or intron), proximal genes (located in the promoter region), and flanking genes (located upstream and downstream within user-specified distance). The <italic>seq2gene</italic> function supports a wide variety of species if a genomic annotation, such as the TxDb (UCSC-based) or EnsDb (Ensembl-based) object, is available. After mapping genomic regions to coding genes, clusterProfiler can be employed to perform functional enrichment analysis of the coding genes to assign biological meanings to the set of genomic regions. The combination of ChIPseeker and clusterProfiler allows more biological ontology or pathway databases to be utilized to explore functions of genomic regions for a wide variety of species.<boxed-text id=\"dtbox4\"><p id=\"p2085\"><list list-type=\"simple\" id=\"ulist0525\"><list-item id=\"u1070\"><p id=\"p2090\">library(ChIPseeker)</p></list-item><list-item id=\"u1075\"><p id=\"p2095\"><bold><italic>## the file can be downloaded using &#x02018;downloadGSMbedFiles(\"GSM1295076\")&#x02019;</italic></bold></p></list-item><list-item id=\"u1080\"><p id=\"p2100\">file &#x0003c;- \"GSM1295076_CBX6_BF_ChipSeq_mergedReps_peaks.bed.gz\"</p></list-item><list-item id=\"u1085\"><p id=\"p2105\">gr &#x0003c;- readPeakFile(file)</p></list-item><list-item id=\"u1090\"><p id=\"p2110\">library(TxDb.Hsapiens.UCSC.hg19.knownGene)</p></list-item><list-item id=\"u1095\"><p id=\"p2115\">TxDb &#x0003c;- TxDb.Hsapiens.UCSC.hg19.knownGene</p></list-item><list-item id=\"u1100\"><p id=\"p2120\">genes &#x0003c;- seq2gene(gr, tssRegion=c(-1000, 1000), flankDistance = 3000, TxDb)</p></list-item><list-item id=\"u1105\"><p id=\"p2125\">library(clusterProfiler)</p></list-item><list-item id=\"u1110\"><p id=\"p2130\">g &#x0003c;- bitr(genes, &#x02018;ENTREZID&#x02019;, &#x02018;SYMBOL&#x02019;, &#x02018;org.Hs.eg.db&#x02019;)</p></list-item><list-item id=\"u1115\"><p id=\"p2135\"><bold><italic>## downloaded from</italic></bold></p><p id=\"p4135\"><ext-link ext-link-type=\"uri\" xlink:href=\"https://maayanlab.cloud/Enrichr/geneSetLibrary?mode=text&#x00026;libraryName=ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X\" id=\"intref0815\"><italic><bold>https://maayanlab.cloud/Enrichr/geneSetLibrary?mode=text&#x00026;libraryName=ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X</bold></italic></ext-link></p></list-item><list-item id=\"u1120\"><p id=\"p2140\">encode &#x0003c;- read.gmt(\"ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X.txt\")</p></list-item><list-item id=\"u1125\"><p id=\"p2145\">enricher(g$SYMBOL, TERM2GENE=encode)</p></list-item></list></p></boxed-text></p><p id=\"p0075\">A dataset of ChIP-seq with antibody against CBX6 (GEO: <ext-link ext-link-type=\"uri\" xlink:href=\"ncbi-geo:GSM1295076\" id=\"interref65\">GSM1295076</ext-link>) was used in the above example. The genomic binding regions were mapped to coding genes using the <italic>seq2gene</italic> function with UCSC genomic annotation. The Entrez gene IDs were converted into gene symbols using the <italic>bitr</italic> function implemented in clusterProfiler. To identify and characterize transcript cofactors, we performed functional enrichment analysis using the ENCODE and ChEA transcript factor gene sets. The result was visualized as a category-gene network (<xref rid=\"fig3\" ref-type=\"fig\">Figure&#x000a0;3</xref>), which showed that genes associated with CBX6 (obtained by the <italic>seq2gene</italic> function) significantly overlap with genes regulated by POU5F1, TRIM28, SUZ12, and EZH2. OCT4 (POU5F1)<xref rid=\"bib34\" ref-type=\"bibr\"><sup>34</sup></xref> and KAP1 (TRIM28)<xref rid=\"bib35\" ref-type=\"bibr\"><sup>35</sup></xref> have been reported to interact with polycomb repressive complex 1 (PRC1), and CBX6 is a known subunit of PRC1.<xref rid=\"bib36\" ref-type=\"bibr\"><sup>36</sup></xref> SUZ12 and EZH2 are core components of PRC2 and negatively regulate CBX6.<xref rid=\"bib37\" ref-type=\"bibr\"><sup>37</sup></xref> These pieces of evidence support the effectiveness of these analyses including the mapping of genomic ROIs to coding genes and functional enrichment, which suggest that this method can be used to identify unknown cofactors (<xref rid=\"fig3\" ref-type=\"fig\">Figure&#x000a0;3</xref>) and characterize functions of genomic regions.<fig id=\"fig3\"><label>Figure&#x000a0;3</label><caption><p>Functional enrichment analysis of genomic regions of interest</p><p>Genomic regions are linked to coding genes, which are then used to identify transcript cofactors by testing significant overlap of target genes.</p></caption><graphic xlink:href=\"gr3\"/></fig></p></sec><sec id=\"sec2.5\"><title>Comparison among different conditions</title><p id=\"p0080\">The clusterProfiler library is designed to allow the comparison of functional enrichment results from multiple experimental conditions or multiple time points. With an input of a collection of gene lists, the <italic>compareCluster</italic> function applies a function (e.g., <italic>enricher</italic>) with user settings to perform functional enrichment analysis for each of the gene lists and aggregates the results into a single object. Thus, enrichment results of multiple groups are easily explored and plotted together for comparison with a user-friendly interface. Comparing functional profiles can reveal functional consensus and differences among different experiments and helps in identifying differential functional modules in omics datasets. In the updated version, <italic>compareCluster</italic> provides a new interface supporting a formula that is widely used in R for specifying statistical models; this allows more complicated experimental designs to be supported (e.g., time-course experiment with different treatments). With the infrastructure of clusterProfiler to support a wide range of ontology and pathway annotations and multiple organisms, the comparison can be applied to many circumstances.</p><p id=\"p0085\">The dataset, DE_GSE8057, was derived from the GEO: <ext-link ext-link-type=\"uri\" xlink:href=\"ncbi-geo:GSE8057\" id=\"intref0025\">GSE8057</ext-link> dataset in the GEO database. The <ext-link ext-link-type=\"uri\" xlink:href=\"ncbi-geo:GSE8057\" id=\"intref0030\">GSE8057</ext-link> dataset contains expression data from ovarian cancer cells at multiple time points (0, 2, 6, and 24 h) and under two treatment conditions (cisplatin and oxaliplatin).<xref rid=\"bib38\" ref-type=\"bibr\"><sup>38</sup></xref> The DE_GSE8057 dataset contains DEGs obtained from different treatments and time points versus control samples. Eight groups of DEG lists (specified by the formula <italic>Gene ~ Time</italic>&#x000a0;+ <italic>Treatment</italic>) were analyzed simultaneously using <italic>compareCluster</italic> with WikiPathways. The result (<xref rid=\"fig4\" ref-type=\"fig\">Figure&#x000a0;4</xref>) indicates that the two drugs have distinct effects at the beginning but consistent effects in the later stages. Several pathways including DNA damage and cell-cycle progression were perturbed by either cisplatin or oxaliplatin drug exposure. The finding is consistent with the discovery obtained by data-driven modeling.<xref rid=\"bib38\" ref-type=\"bibr\"><sup>38</sup></xref><boxed-text id=\"dtbox5\"><p id=\"p2150\"><list list-type=\"simple\" id=\"ulist0530\"><list-item id=\"u1130\"><p id=\"p2155\">data(DE_GSE8057)</p></list-item><list-item id=\"u1135\"><p id=\"p2160\">xx &#x0003c;- compareCluster(Gene&#x0223c;time+treatment, data=DE_GSE8057, fun = enricher,</p></list-item><list-item id=\"u1140\"><p id=\"p2165\">TERM2GENE=wp[,c(\"wpid\", \"gene\")], TERM2NAME=wp[,c(\"wpid\", \"name\")])</p></list-item></list></p></boxed-text><fig id=\"fig4\"><label>Figure&#x000a0;4</label><caption><p>Comparing functional profiles among different levels of conditions</p><p>The <italic>compareCluster</italic> function performed enrichment analysis simultaneously for eight lists of DEGs. The results were visualized as a dot plot with an x axis representing one level of conditions (time course) and a facet panel indicating another level of conditions (drug treatments).</p></caption><graphic xlink:href=\"gr4\"/></fig></p></sec><sec id=\"sec2.6\"><title>Data frame interface for accessing enriched results</title><p id=\"p0090\">The outputs of ORA and GSEA are <italic>enrichResult</italic> and <italic>gseaResult</italic> objects, respectively, while the output of <italic>compareCluster</italic> is a <italic>compareClusterResult</italic> object. These S4 objects contain input data, analysis settings, and enriched results, which allow more informative data to be available for downstream interpretation and visualization. To enable easy access to the enriched result, clusterProfiler implements <italic>as</italic>.<italic>data</italic>.<italic>frame</italic> methods to convert the S4 objects to data frames that can be easily exported as CSV files. In addition, clusterProfiler provides a data frame interface that mimics data frame operations to access rows, columns, and subsets of rows and columns from the S4 objects of the enriched result. Users can use <italic>head</italic> and <italic>tail</italic> to print part of the result. The <italic>nrow</italic>, <italic>ncol</italic>, and <italic>dim</italic> methods are also supported to access basic information such as how many pathways are enriched.<boxed-text id=\"dtbox6\"><p id=\"p2170\"><list list-type=\"simple\" id=\"ulist0535\"><list-item id=\"u1145\"><p id=\"p2175\"><italic>## head or tail to print first or last n rows</italic></p></list-item><list-item id=\"u1150\"><p id=\"p2180\"><bold>head</bold>(ego, 2)</p></list-item><list-item id=\"u1155\"><p id=\"p2185\">## ID Description GeneRatio BgRatio pvalue</p></list-item><list-item id=\"u1160\"><p id=\"p2190\">## GO:0140014 GO:0140014 mitotic nuclear division 34/194 286/18866 2.171838e-26</p></list-item><list-item id=\"u1165\"><p id=\"p2195\">## GO:0000280 GO:0000280 nuclear division 36/194 428/18866 1.099719e-22</p></list-item><list-item id=\"u1170\"><p id=\"p2200\">## p.adjust qvalue</p></list-item><list-item id=\"u1175\"><p id=\"p2205\">## GO:0140014 6.700119e-23 5.710790e-23</p></list-item><list-item id=\"u1180\"><p id=\"p2210\">## GO:0000280 1.696316e-19 1.445841e-19</p></list-item><list-item id=\"u1185\"><p id=\"p2215\">## geneID</p></list-item><list-item id=\"u1190\"><p id=\"p2220\">## GO:0140014 CDCA8/CDC20/KIF23/CENPE/MYBL2/CCNB2/NDC80/NCAPH/DLGAP5/UBE2C/NUSAP1/TPX2/TACC3/NEK2/UBE2S/CDK1/MAD2L1/KIF18A/CDT1/BIRC5/KIF11/TTK/NCAPG/AURKB/CHEK1/TRIP13/PRC1/KIFC1/KIF18B/AURKA/CCNB1/KIF4A/PTTG1/BMP4</p></list-item><list-item id=\"u1195\"><p id=\"p2225\">## GO:0000280 CDCA8/CDC20/KIF23/CENPE/MYBL2/CCNB2/NDC80/TOP2A/NCAPH/ASPM/DLGAP5/UBE2C/NUSAP1/TPX2/TACC3/NEK2/UBE2S/CDK1/MAD2L1/KIF18A/CDT1/BIRC5/KIF11/TTK/NCAPG/AURKB/CHEK1/TRIP13/PRC1/KIFC1/KIF18B/AURKA/CCNB1/KIF4A/PTTG1/BMP4</p></list-item><list-item id=\"u1200\"><p id=\"p2230\">## Count</p></list-item><list-item id=\"u1205\"><p id=\"p2235\">## GO:0140014 34</p></list-item><list-item id=\"u1210\"><p id=\"p2240\">## GO:0000280 36</p></list-item></list></p></boxed-text></p><p id=\"p0095\">The [ and <italic>$</italic> operators for subsetting are also supported. We redefined the [[ operator to help users access which genes are annotated by a selected ontology or pathway. For GSEA output, the [[ operator will return core enriched genes (i.e., genes in the leading edge) of the selected gene set.<boxed-text id=\"dtbox7\"><p id=\"p2245\"><list list-type=\"simple\" id=\"ulist0540\"><list-item id=\"u1215\"><p id=\"p2250\"><italic>## subset result using &#x02018;[&#x02019; and &#x02018;$&#x02019;</italic></p></list-item><list-item id=\"u1220\"><p id=\"p2255\">ego[1:2, <bold>c</bold>(\"ID\", \"Description\", \"pvalue\", \"p.adjust\")]</p></list-item><list-item id=\"u1225\"><p id=\"p2260\">## ID Description pvalue p.adjust</p></list-item><list-item id=\"u1230\"><p id=\"p2265\">## GO:0140014 GO:0140014 mitotic nuclear division 2.171838e-26 6.700119e-23</p></list-item><list-item id=\"u1235\"><p id=\"p2270\">## GO:0000280 GO:0000280 nuclear division 1.099719e-22 1.696316e-19</p></list-item><list-item id=\"u1240\"><p id=\"p2275\"><bold>head</bold>(ego<bold>$</bold>Description)</p></list-item><list-item id=\"u1245\"><p id=\"p2280\">## [1] \"mitotic nuclear division\"</p></list-item><list-item id=\"u1250\"><p id=\"p2285\">## [2] \"nuclear division\"</p></list-item><list-item id=\"u1255\"><p id=\"p2290\">## [3] \"organelle fission\"</p></list-item><list-item id=\"u1260\"><p id=\"p2295\">## [4] \"mitotic sister chromatid segregation\"</p></list-item><list-item id=\"u1265\"><p id=\"p2300\">## [5] \"sister chromatid segregation\"</p></list-item><list-item id=\"u1270\"><p id=\"p2305\">## [6] \"chromosome segregation\"</p></list-item><list-item id=\"u1275\"><p id=\"p2310\"><italic>## genes annotated by specific term</italic></p></list-item><list-item id=\"u1280\"><p id=\"p2315\">ego[[\"GO:0140014\"]]</p></list-item><list-item id=\"u1285\"><p id=\"p2320\">## [1] \"CDCA8\" \"CDC20\" \"KIF23\" \"CENPE\" \"MYBL2\" \"CCNB2\" \"NDC80\" \"NCAPH\"</p></list-item><list-item id=\"u1290\"><p id=\"p2325\">## [9] \"DLGAP5\" \"UBE2C\" \"NUSAP1\" \"TPX2\" \"TACC3\" \"NEK2\" \"UBE2S\" \"CDK1\"</p></list-item><list-item id=\"u1295\"><p id=\"p2330\">## [17] \"MAD2L1\" \"KIF18A\" \"CDT1\" \"BIRC5\" \"KIF11\" \"TTK\" \"NCAPG\" \"AURKB\"</p></list-item><list-item id=\"u1300\"><p id=\"p2335\">## [25] \"CHEK1\" \"TRIP13\" \"PRC1\" \"KIFC1\" \"KIF18B\" \"AURKA\" \"CCNB1\" \"KIF4A\"</p></list-item><list-item id=\"u1305\"><p id=\"p2340\">## [33] \"PTTG1\" \"BMP4\"</p></list-item></list></p></boxed-text></p></sec><sec id=\"sec2.7\"><title>Tidy interface for data operation</title><p id=\"p0100\">To facilitate data manipulation and exploration of the enrichment result, clusterProfiler extends the <italic>dplyr</italic> verbs to support <italic>enrichResult</italic>, <italic>gseaResult</italic>, and <italic>compareClusterResult</italic> objects. Following the concept of tidiness, these verbs provide robust and standardized operations for data transformation and can be assembled into a workflow using the pipe operator (%&#x0003e;%). This allows users to explore the results effectively and develop reproducible and human-readable pipelines. For example, it allows the filtering of enriched results using different criteria (e.g., adjusted p values less than 0.001, and the&#x000a0;number of input genes annotated to the enriched term should be greater than 10).<boxed-text id=\"dtbox8\"><p id=\"p2345\"><list list-type=\"simple\" id=\"ulist0545\"><list-item id=\"u1310\"><p id=\"p2350\"><bold>dim</bold>(ego)</p></list-item><list-item id=\"u1315\"><p id=\"p2355\">## [1] 197 9</p></list-item><list-item id=\"u1320\"><p id=\"p2360\">ego2 &#x0003c;- <bold>filter</bold>(ego, p.adjust <bold>&#x0003c;</bold> 0.001, Count <bold>&#x0003e;</bold> 10)</p></list-item><list-item id=\"u1325\"><p id=\"p2365\"><bold>dim</bold>(ego2)</p></list-item><list-item id=\"u1330\"><p id=\"p2370\">## [1] 44 9</p></list-item></list></p></boxed-text></p><p id=\"p0105\">For ORA results, clusterProfiler provides <italic>geneRatio</italic> (ratio of input genes that are annotated in a term) and <italic>BgRatio</italic> (ratio of all genes that are annotated in this term). However, other concepts are widely used to help in interpreting enrichment results, such as the rich factor and fold enrichment. A rich factor is defined as the ratio of input genes (e.g., DEGs) that are annotated in a term to all genes that are annotated in this term. The fold enrichment is defined as the ratio of the frequency of input genes annotated in a term to the frequency of all genes annotated to that term, and it is easy to calculate by dividing <italic>geneRatio</italic> by <italic>BgRatio</italic>. Here, as an example, we used the <italic>mutate</italic> verb to create a new column of <italic>richFactor</italic> based on information available in the clusterProfiler output.<boxed-text id=\"dtbox9\"><p id=\"p2375\"><list list-type=\"simple\" id=\"ulist0550\"><list-item id=\"u1335\"><p id=\"p2380\">ego3 &#x0003c;- <bold>mutate</bold>(ego, richFactor = Count / <bold>as.numeric</bold>(<bold>sub</bold>(\"/\\\\d+\", \"\", BgRatio)))</p></list-item></list></p></boxed-text></p><p id=\"p0110\">The following example uses the GSEA enrichment result generated in the previous session. The result was sorted by absolute values of NESs using the <italic>arrange</italic> verb. NES is an indicator to interpret the degree of enrichment. A positive NES indicates that members of the gene set tend to appear at the top of the rank (pathway activation), and a negative NES indicates the opposite circumstance (pathway suppression). We used the <italic>group_by</italic> verb to group the result based on the sign of NES, and the <italic>slice</italic> verb was used to extract the first five enriched pathways for each group (i.e., five activated pathways that have the largest NES values and five suppressed pathways that have the smallest NES values). These verbs return the same object type as their input and do not affect downstream analysis and visualization.<boxed-text id=\"dtbox10\"><p id=\"p2385\"><list list-type=\"simple\" id=\"ulist0555\"><list-item id=\"u1340\"><p id=\"p2390\">ewp2 &#x0003c;- <bold>arrange</bold>(ewp, <bold>desc</bold>(<bold>abs</bold>(NES))) <bold>%&#x0003e;%</bold></p></list-item><list-item id=\"u1345\"><p id=\"p2395\"><bold>group_by</bold>(<bold>sign</bold>(NES)) <bold>%&#x0003e;%</bold></p></list-item><list-item id=\"u1350\"><p id=\"p2400\"><bold>slice</bold>(1:5)</p></list-item></list></p></boxed-text></p></sec><sec id=\"sec2.8\"><title>Visualization using Ggplot2</title><p id=\"p0115\">The <italic>enrichplot</italic> package is originally derived from DOSE and clusterProfiler packages and serves as a <italic>de facto</italic> visualization tool for visualizing enrichment results for outputs from clusterProfiler as well as DOSE, ReactomePA, and meshes. These methods allow users without programming skills to generate effective visualization to explore and interpret results. All the visualization methods implemented are based on <italic>ggplot2</italic>, which allows customization using the grammar of graphics. Moreover, we also extend <italic>ggplot2</italic> to support enrichment results so that users can use the <italic>ggplot2</italic> syntax directly to visualize enrichment results. The following example demonstrates the application of <italic>ggplot2</italic> grammar of graphics to visualize the GO enrichment result (ORA) as a lollipop chart using the rich factor that was generated in the previous session using the <italic>dplyr</italic> verbs (<xref rid=\"fig5\" ref-type=\"fig\">Figure&#x000a0;5</xref>A).<boxed-text id=\"dtbox11\"><p id=\"p2405\"><list list-type=\"simple\" id=\"ulist0560\"><list-item id=\"u1355\"><p id=\"p2410\">library(ggplot2)</p></list-item><list-item id=\"u1360\"><p id=\"p2415\">library(forcats)</p></list-item><list-item id=\"u1365\"><p id=\"p2420\">ggplot(ego3, showCategory = 10,</p></list-item><list-item id=\"u1370\"><p id=\"p2425\">aes(richFactor, fct_reorder(Description, richFactor))) +</p></list-item><list-item id=\"u1375\"><p id=\"p2430\">geom_segment(aes(xend=0, yend = Description)) +</p></list-item><list-item id=\"u1380\"><p id=\"p2435\">geom_point(aes(color=p.adjust, size = Count)) +</p></list-item><list-item id=\"u1385\"><p id=\"p2440\">scale_color_gradientn(colours=c(\"#f7ca64\", \"#46bac2\", \"#7e62a3\"),</p></list-item><list-item id=\"u1390\"><p id=\"p2445\">trans = \"log10\",</p></list-item><list-item id=\"u1395\"><p id=\"p2450\">guide=guide_colorbar(reverse=TRUE, order=1)) +</p></list-item><list-item id=\"u1400\"><p id=\"p2455\">scale_size_continuous(range=c(2, 10)) +</p></list-item><list-item id=\"u1405\"><p id=\"p2460\">theme_dose(12) +</p></list-item><list-item id=\"u1410\"><p id=\"p2465\">xlab(\"Rich Factor\") +</p></list-item><list-item id=\"u1415\"><p id=\"p2470\">lab(NULL) +</p></list-item><list-item id=\"u1420\"><p id=\"p2475\">ggtitle(\"Biological Processes\")</p></list-item></list></p></boxed-text><fig id=\"fig5\"><label>Figure&#x000a0;5</label><caption><p>Visualizing enrichment results using <italic>ggplot2</italic></p><p>A lollipop chart to visualize the rich factors from ORA (A) and a bar chart to visualize normalized enrichment scores from GSEA (B).</p></caption><graphic xlink:href=\"gr5\"/></fig></p><p id=\"p0120\">In <xref rid=\"fig5\" ref-type=\"fig\">Figure&#x000a0;5</xref>B, the most significant activated and suppressed pathways (GSEA) selected by a series of <italic>dplyr</italic> verb operations are visualized as a bar chart using the <italic>ggplot2</italic> syntax. Although visualization methods used to generate <xref rid=\"fig5\" ref-type=\"fig\">Figure&#x000a0;5</xref> are not provided in clusterProfiler, it is easy to generate such graphs using the tidy interface and&#x000a0;<italic>ggplot2</italic>. The combination of the tidy interface for data wrangling&#x000a0;and the support of <italic>ggplot2</italic> for visualization creates many possibilities for&#x000a0;users to explore and visualize enrichment results using consistent&#x000a0;grammar. It allows novel exploratory approaches to reveal unanticipated mechanisms as well as prototyping new visualization methods.<boxed-text id=\"dtbox12\"><p id=\"p2480\"><list list-type=\"simple\" id=\"ulist0565\"><list-item id=\"u1425\"><p id=\"p2485\">ggplot(ewp2, showCategory=10,</p></list-item><list-item id=\"u1430\"><p id=\"p2490\">aes(NES, fct_reorder(Description, NES), fill=qvalues)) +</p></list-item><list-item id=\"u1435\"><p id=\"p2495\">geom_col() +</p></list-item><list-item id=\"u1440\"><p id=\"p2500\">scale_fill_gradientn(colours=c(\"#b3eebe\", \"#46bac2\", \"#371ea3\"),</p></list-item><list-item id=\"u1445\"><p id=\"p2505\">guide=guide_colorbar(reverse=TRUE)) +</p></list-item><list-item id=\"u1450\"><p id=\"p2510\">theme_dose(12) +</p></list-item><list-item id=\"u1455\"><p id=\"p2515\">xlab(\"Normalized Enrichment Score\") +</p></list-item><list-item id=\"u1460\"><p id=\"p2520\">ylab(NULL) +</p></list-item><list-item id=\"u1465\"><p id=\"p2525\">ggtitle(\"WikiPathways\")</p></list-item></list></p></boxed-text></p></sec><sec id=\"sec2.9\"><title>Package interoperability</title><p id=\"p0125\">The clusterProfiler package is a versatile tool for enrichment analysis. It is developed within the Bioconductor ecosystem and has become an essential part of this ecosystem. Currently there are more than 30&#x000a0;R packages that rely on clusterProfiler to perform functional analysis for different topics, especially for cancer research. GO analysis relies on GO annotation maintained by the community, and the enrichment analysis for genomic regions relies on genomic annotation maintained by UCSC and Ensembl. There are R packages that contain gene set annotation (e.g., msigdbr) and R client libraries for accessing pathway data (e.g., rWikiPathways). These data can be used directly as background annotation in clusterProfiler through the universal interface to characterize the functional profile of omics data. The ORA algorithm is implemented in the DOSE package<xref rid=\"bib21\" ref-type=\"bibr\"><sup>21</sup></xref> developed in-house, and the GSEA algorithm is implemented in DOSE and fgsea<xref rid=\"bib39\" ref-type=\"bibr\"><sup>39</sup></xref> packages.</p><p id=\"p0130\">Our team has developed several packages to complement the functionality of clusterProfiler. ChIPseeker<xref rid=\"bib10\" ref-type=\"bibr\"><sup>10</sup></xref> bridges the genomic region with functional enrichment by annotating the genomic region to associated genes. GOSemSim<xref rid=\"bib11\" ref-type=\"bibr\"><sup>11</sup></xref> provides more than five methods for measuring semantic similarity. It allows removal of redundant terms using semantic similarities among GO terms and allows enrichment results to be visualized in semantic space so that similar terms cluster together. The DOSE<xref rid=\"bib24\" ref-type=\"bibr\"><sup>24</sup></xref> package supports functional enrichment from the disease perspective, including disease ontology, the network of cancer genes, and disease gene network. The ReactomePA<xref rid=\"bib25\" ref-type=\"bibr\"><sup>25</sup></xref> and meshes<xref rid=\"bib26\" ref-type=\"bibr\"><sup>26</sup></xref> packages support functional analysis using Reactome Pathways and Medical Subject Headings, respectively. DOSE, ReactomePA, and meshes are developed within the framework of clusterProfiler, and the enrichment analysis functions provided in these packages can be used in <italic>compareCluster</italic> for the comparison of functional profiles under various conditions and at different time points. The enrichplot package provides several visualization methods to generate publication-quality figures to help users interpret the results (<xref rid=\"fig1\" ref-type=\"fig\">Figures 1</xref>, <xref rid=\"fig2\" ref-type=\"fig\">2</xref>, <xref rid=\"fig3\" ref-type=\"fig\">3</xref>, and <xref rid=\"fig4\" ref-type=\"fig\">4</xref>; <xref rid=\"appsec1\" ref-type=\"sec\">supplemental information</xref>). This package suite provides a comprehensive set of tools for mining biological knowledge to elucidate and interpret molecular mechanisms (<xref rid=\"fig6\" ref-type=\"fig\">Figure&#x000a0;6</xref>).<fig id=\"fig6\"><label>Figure&#x000a0;6</label><caption><p>A package suite for mining biological knowledge</p><p>clusterProfiler is an essential core for functional analysis, the functionalities of which are enhanced by several companion packages.</p></caption><graphic xlink:href=\"gr6\"/></fig></p></sec></sec><sec id=\"sec3\"><title>Discussion and conclusions</title><p id=\"p0135\">Pathway enrichment analysis is an essential step toward identifying biological themes that are most characteristic of high-throughput sequencing data. The clusterProfiler library provides a set of functions to unveil biological functions and pathways. Compared with many other tools that do not update background annotation databases in timely fashion and only support a limited number of organisms, clusterProfiler uses up-to-date biological knowledge of genes and biological processes (GO and KEGG) and supports thousands of organisms. In addition, clusterProfiler provides a universal interface for functional analysis with user-provided annotations. This creates the possibility to apply clusterProfiler on functional characterization of different types of data with different biological knowledge. The tidy interface provided in clusterProfiler harmonizes data structures and workflows and makes it easier for the community to develop modular manipulation, visualization, and analysis methods to supplement the existing ecosystem. clusterProfiler has already been integrated into more than 30 packages to perform functional analysis on data obtained using different techniques, including ATAC-seq, multi-region sequencing (MRS), CRISPR/Cas9 screens, and mass spectrometry (<xref rid=\"mmc1\" ref-type=\"supplementary-material\">Table S1</xref>). The clusterProfiler package can be easily integrated into analysis pipelines. For example, the Gene Ontology Meta Annotator for Plants (GOMAP) is optimized for GO annotation of large, repetitive plant genomes.<xref rid=\"bib40\" ref-type=\"bibr\"><sup>40</sup></xref> Users can develop a pipeline to combine GOMAP with clusterProfiler to characterize the functionality of sequencing data from plant species, including wheat, maize, soy, and rice. The clusterProfiler library has been incorporated into different pipelines, such as TCGA Workflow,<xref rid=\"bib12\" ref-type=\"bibr\"><sup>12</sup></xref> recount workflow,<xref rid=\"bib41\" ref-type=\"bibr\"><sup>41</sup></xref> RNASeqR,<xref rid=\"bib42\" ref-type=\"bibr\"><sup>42</sup></xref> and MAGeCKFlute.<xref rid=\"bib43\" ref-type=\"bibr\"><sup>43</sup></xref></p><p id=\"p0140\">clusterProfiler 4.0 contains several new features, including the tidy interface and the compatibility of using <italic>ggplot2</italic> for visualization. There is no API change for functional enrichment analyses, and this version is fully compatible with downstream packages (<xref rid=\"mmc1\" ref-type=\"supplementary-material\">Table S1</xref>). After long-term maintenance, clusterProfiler is mature and unlikely to introduce significant API changes in future development. In the event of an API change, we will maintain backward compatibility for at least 1 year and provide a warning message about the change. The clusterProfiler library is freely available at <ext-link ext-link-type=\"uri\" xlink:href=\"https://www.bioconductor.org/packages/clusterProfiler\" id=\"intref0035\">https://www.bioconductor.org/packages/clusterProfiler</ext-link>. The development version of clusterProfiler is hosted on GitHub (<ext-link ext-link-type=\"uri\" xlink:href=\"https://github.com/YuLab-SMU/clusterProfiler\" id=\"intref0040\">https://github.com/YuLab-SMU/clusterProfiler</ext-link>), with many active users. A complete reference of the package suite (<xref rid=\"fig6\" ref-type=\"fig\">Figure&#x000a0;6</xref>) is available in the online book, <ext-link ext-link-type=\"uri\" xlink:href=\"https://yulab-smu.top/biomedical-knowledge-mining-book/\" id=\"intref0050\">https://yulab-smu.top/biomedical-knowledge-mining-book/</ext-link>, with many examples and detailed explanations on biological knowledge mining. Source codes to reproduce <xref rid=\"fig1\" ref-type=\"fig\">Figures 1</xref>, <xref rid=\"fig2\" ref-type=\"fig\">2</xref>, <xref rid=\"fig3\" ref-type=\"fig\">3</xref>, <xref rid=\"fig4\" ref-type=\"fig\">4</xref>, and <xref rid=\"fig5\" ref-type=\"fig\">5</xref>, as well as detailed information about the datasets used in the examples, are available in <xref rid=\"appsec1\" ref-type=\"sec\">supplemental information</xref>. The clusterProfiler library is one of the popular tools used in functional enrichment analysis (more than 2,500 citations in 2020 according to Google Scholar), and we anticipate that clusterProfiler will continue to be a valuable resource to support the discovery of mechanistic insights and improve our understanding of health and disease.</p></sec></body><back><ref-list id=\"cebib0010\"><title>References</title><ref id=\"bib1\"><label>1</label><element-citation publication-type=\"journal\" id=\"sref1\"><person-group person-group-type=\"author\"><name><surname>Dozmorov</surname><given-names>M.G.</given-names></name></person-group><article-title>Epigenomic annotation-based interpretation of genomic data: from enrichment analysis to machine learning</article-title><source>Bioinformatics</source><volume>33</volume><year>2017</year><fpage>3323</fpage><lpage>3330</lpage><pub-id pub-id-type=\"pmid\">29028263</pub-id></element-citation></ref><ref id=\"bib2\"><label>2</label><element-citation publication-type=\"journal\" id=\"sref2\"><person-group person-group-type=\"author\"><name><surname>Priebe</surname><given-names>S.</given-names></name><name><surname>Kreisel</surname><given-names>C.</given-names></name><name><surname>Horn</surname><given-names>F.</given-names></name><etal/></person-group><article-title>FungiFun2: a comprehensive online resource for systematic analysis of gene lists from fungal species</article-title><source>Bioinformatics</source><volume>31</volume><year>2015</year><fpage>445</fpage><lpage>446</lpage><pub-id pub-id-type=\"pmid\">25294921</pub-id></element-citation></ref><ref id=\"bib3\"><label>3</label><element-citation publication-type=\"journal\" id=\"sref3\"><person-group person-group-type=\"author\"><name><surname>Yi</surname><given-names>X.</given-names></name><name><surname>Du</surname><given-names>Z.</given-names></name><name><surname>Su</surname><given-names>Z.</given-names></name></person-group><article-title>PlantGSEA: a gene set enrichment analysis toolkit for plant community</article-title><source>Nucleic Acids Res.</source><volume>41</volume><year>2013</year><fpage>W98</fpage><lpage>W103</lpage><pub-id pub-id-type=\"pmid\">23632162</pub-id></element-citation></ref><ref id=\"bib4\"><label>4</label><element-citation publication-type=\"journal\" id=\"sref4\"><person-group person-group-type=\"author\"><name><surname>Nam</surname><given-names>D.</given-names></name><name><surname>Kim</surname><given-names>S.-Y.</given-names></name></person-group><article-title>Gene-set approach for expression pattern analysis</article-title><source>Brief. Bioinform.</source><volume>9</volume><year>2008</year><fpage>189</fpage><lpage>197</lpage><pub-id pub-id-type=\"pmid\">18202032</pub-id></element-citation></ref><ref id=\"bib5\"><label>5</label><element-citation publication-type=\"journal\" id=\"sref5\"><person-group person-group-type=\"author\"><name><surname>Wadi</surname><given-names>L.</given-names></name><name><surname>Meyer</surname><given-names>M.</given-names></name><name><surname>Weiser</surname><given-names>J.</given-names></name><etal/></person-group><article-title>Impact of outdated gene annotations on pathway enrichment analysis</article-title><source>Nat. Methods</source><volume>13</volume><year>2016</year><fpage>705</fpage><lpage>706</lpage><pub-id pub-id-type=\"pmid\">27575621</pub-id></element-citation></ref><ref id=\"bib6\"><label>6</label><element-citation publication-type=\"journal\" id=\"sref6\"><person-group person-group-type=\"author\"><name><surname>Mel&#x000e9;</surname><given-names>M.</given-names></name><name><surname>Ferreira</surname><given-names>P.G.</given-names></name><name><surname>Reverter</surname><given-names>F.</given-names></name><etal/></person-group><article-title>The human transcriptome across tissues and individuals</article-title><source>Science</source><volume>348</volume><year>2015</year><fpage>660</fpage><lpage>665</lpage><pub-id pub-id-type=\"pmid\">25954002</pub-id></element-citation></ref><ref id=\"bib7\"><label>7</label><element-citation publication-type=\"journal\" id=\"sref7\"><person-group person-group-type=\"author\"><name><surname>Yu</surname><given-names>G.</given-names></name><name><surname>Wang</surname><given-names>L.-G.</given-names></name><name><surname>Han</surname><given-names>Y.</given-names></name><etal/></person-group><article-title>clusterProfiler: an R Package for comparing biological themes among gene clusters</article-title><source>OMICS J. Integr. Biol.</source><volume>16</volume><year>2012</year><fpage>284</fpage><lpage>287</lpage></element-citation></ref><ref id=\"bib8\"><label>8</label><element-citation publication-type=\"journal\" id=\"sref8\"><person-group person-group-type=\"author\"><name><surname>Boyle</surname><given-names>E.I.</given-names></name><name><surname>Weng</surname><given-names>S.</given-names></name><name><surname>Gollub</surname><given-names>J.</given-names></name><etal/></person-group><article-title>GO::TermFinder&#x02014;open source software for accessing Gene Ontology information and finding significantly enriched Gene Ontology terms associated with a list of genes</article-title><source>Bioinformatics</source><volume>20</volume><year>2004</year><fpage>3710</fpage><lpage>3715</lpage><pub-id pub-id-type=\"pmid\">15297299</pub-id></element-citation></ref><ref id=\"bib9\"><label>9</label><element-citation publication-type=\"journal\" id=\"sref9\"><person-group person-group-type=\"author\"><name><surname>Subramanian</surname><given-names>A.</given-names></name><name><surname>Tamayo</surname><given-names>P.</given-names></name><name><surname>Mootha</surname><given-names>V.K.</given-names></name><etal/></person-group><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title><source>Proc. Natl. Acad. Sci. U S A</source><volume>102</volume><year>2005</year><fpage>15545</fpage><lpage>15550</lpage><pub-id pub-id-type=\"pmid\">16199517</pub-id></element-citation></ref><ref id=\"bib10\"><label>10</label><element-citation publication-type=\"journal\" id=\"sref10\"><person-group person-group-type=\"author\"><name><surname>Yu</surname><given-names>G.</given-names></name><name><surname>Wang</surname><given-names>L.-G.</given-names></name><name><surname>He</surname><given-names>Q.-Y.</given-names></name></person-group><article-title>ChIPseeker: an R/Bioconductor package for&#x000a0;ChIP peak annotation, comparison and visualization</article-title><source>Bioinformatics</source><volume>31</volume><year>2015</year><fpage>2382</fpage><lpage>2383</lpage><pub-id pub-id-type=\"pmid\">25765347</pub-id></element-citation></ref><ref id=\"bib11\"><label>11</label><element-citation publication-type=\"journal\" id=\"sref11\"><person-group person-group-type=\"author\"><name><surname>Yu</surname><given-names>G.</given-names></name></person-group><article-title>Gene ontology semantic similarity analysis using GOSemSim</article-title><source>Methods Mol. Biol. Clifton NJ</source><volume>2117</volume><year>2020</year><fpage>207</fpage><lpage>215</lpage></element-citation></ref><ref id=\"bib12\"><label>12</label><element-citation publication-type=\"journal\" id=\"sref12\"><person-group person-group-type=\"author\"><name><surname>Silva</surname><given-names>T.C.</given-names></name><name><surname>Colaprico</surname><given-names>A.</given-names></name><name><surname>Olsen</surname><given-names>C.</given-names></name><etal/></person-group><article-title>TCGA Workflow: analyze cancer genomics and epigenomics data using Bioconductor packages</article-title><source>F1000Research.</source><volume>5</volume><year>2016</year><fpage>1542</fpage><pub-id pub-id-type=\"pmid\">28232861</pub-id></element-citation></ref><ref id=\"bib13\"><label>13</label><element-citation publication-type=\"journal\" id=\"sref13\"><person-group person-group-type=\"author\"><name><surname>Treveil</surname><given-names>A.</given-names></name><name><surname>Bohar</surname><given-names>B.</given-names></name><name><surname>Sudhakar</surname><given-names>P.</given-names></name><etal/></person-group><article-title>ViralLink: an integrated workflow to investigate the effect of SARS-CoV-2 on intracellular signalling and regulatory pathways</article-title><source>PLOS Comput. Biol.</source><volume>17</volume><year>2021</year><fpage>e1008685</fpage><pub-id pub-id-type=\"pmid\">33534793</pub-id></element-citation></ref><ref id=\"bib14\"><label>14</label><element-citation publication-type=\"journal\" id=\"sref14\"><person-group person-group-type=\"author\"><name><surname>Yousif</surname><given-names>A.</given-names></name><name><surname>Drou</surname><given-names>N.</given-names></name><name><surname>Rowe</surname><given-names>J.</given-names></name><etal/></person-group><article-title>NASQAR: a web-based platform for high-throughput sequencing data analysis and visualization</article-title><source>BMC Bioinformatics</source><volume>21</volume><year>2020</year><fpage>267</fpage><pub-id pub-id-type=\"pmid\">32600310</pub-id></element-citation></ref><ref id=\"bib15\"><label>15</label><element-citation publication-type=\"journal\" id=\"sref15\"><person-group person-group-type=\"author\"><name><surname>Zou</surname><given-names>Y.</given-names></name><name><surname>Bui</surname><given-names>T.T.</given-names></name><name><surname>Selvarajoo</surname><given-names>K.</given-names></name></person-group><article-title>ABioTrans: a biostatistical tool for transcriptomics analysis</article-title><source>Front. Genet.</source><volume>10</volume><year>2019</year><fpage>499</fpage><pub-id pub-id-type=\"pmid\">31214245</pub-id></element-citation></ref><ref id=\"bib16\"><label>16</label><element-citation publication-type=\"journal\" id=\"sref16\"><person-group person-group-type=\"author\"><collab>The Gene Ontology Consortium</collab></person-group><article-title>The gene ontology resource: 20 years and still GOing strong</article-title><source>Nucleic Acids Res.</source><volume>47</volume><year>2019</year><fpage>D330</fpage><lpage>D338</lpage><pub-id pub-id-type=\"pmid\">30395331</pub-id></element-citation></ref><ref id=\"bib17\"><label>17</label><element-citation publication-type=\"journal\" id=\"sref17\"><person-group person-group-type=\"author\"><name><surname>Yu</surname><given-names>G.</given-names></name><name><surname>Li</surname><given-names>F.</given-names></name><name><surname>Qin</surname><given-names>Y.</given-names></name><etal/></person-group><article-title>GOSemSim: an R package for measuring semantic similarity among GO terms and gene products</article-title><source>Bioinformatics</source><volume>26</volume><year>2010</year><fpage>976</fpage><lpage>978</lpage><pub-id pub-id-type=\"pmid\">20179076</pub-id></element-citation></ref><ref id=\"bib18\"><label>18</label><element-citation publication-type=\"journal\" id=\"sref18\"><person-group person-group-type=\"author\"><name><surname>Haynes</surname><given-names>W.A.</given-names></name><name><surname>Tomczak</surname><given-names>A.</given-names></name><name><surname>Khatri</surname><given-names>P.</given-names></name></person-group><article-title>Gene annotation bias impedes biomedical research</article-title><source>Sci. Rep.</source><volume>8</volume><year>2018</year><fpage>1362</fpage><pub-id pub-id-type=\"pmid\">29358745</pub-id></element-citation></ref><ref id=\"bib19\"><label>19</label><element-citation publication-type=\"journal\" id=\"sref19\"><person-group person-group-type=\"author\"><name><surname>Kanehisa</surname><given-names>M.</given-names></name><name><surname>Furumichi</surname><given-names>M.</given-names></name><name><surname>Tanabe</surname><given-names>M.</given-names></name><etal/></person-group><article-title>KEGG: new perspectives on genomes, pathways, diseases and drugs</article-title><source>Nucleic Acids Res.</source><volume>45</volume><year>2017</year><fpage>D353</fpage><lpage>D361</lpage><pub-id pub-id-type=\"pmid\">27899662</pub-id></element-citation></ref><ref id=\"bib20\"><label>20</label><element-citation publication-type=\"journal\" id=\"sref20\"><person-group person-group-type=\"author\"><name><surname>Zolti</surname><given-names>A.</given-names></name><name><surname>Green</surname><given-names>S.J.</given-names></name><name><surname>Sela</surname><given-names>N.</given-names></name><etal/></person-group><article-title>The microbiome as a biosensor: functional profiles elucidate hidden stress in hosts</article-title><source>Microbiome</source><volume>8</volume><year>2020</year><fpage>71</fpage><pub-id pub-id-type=\"pmid\">32438915</pub-id></element-citation></ref><ref id=\"bib21\"><label>21</label><element-citation publication-type=\"journal\" id=\"sref21\"><person-group person-group-type=\"author\"><name><surname>Alison</surname><given-names>M.R.</given-names></name><name><surname>Hunt</surname><given-names>T.</given-names></name><name><surname>Forbes</surname><given-names>S.J.</given-names></name></person-group><article-title>Minichromosome maintenance (MCM) proteins may be pre-cancer markers</article-title><source>Gut</source><volume>50</volume><year>2002</year><fpage>290</fpage><lpage>291</lpage><pub-id pub-id-type=\"pmid\">11839701</pub-id></element-citation></ref><ref id=\"bib22\"><label>22</label><element-citation publication-type=\"journal\" id=\"sref22\"><person-group person-group-type=\"author\"><name><surname>Miossec</surname><given-names>P.</given-names></name></person-group><article-title>Local and systemic effects of IL-17 in joint inflammation: a historical perspective from discovery to targeting</article-title><source>Cell. Mol. Immunol.</source><volume>18</volume><year>2021</year><fpage>860</fpage><lpage>865</lpage><pub-id pub-id-type=\"pmid\">33692481</pub-id></element-citation></ref><ref id=\"bib23\"><label>23</label><element-citation publication-type=\"journal\" id=\"sref23\"><person-group person-group-type=\"author\"><name><surname>Heink</surname><given-names>S.</given-names></name><name><surname>Ludwig</surname><given-names>D.</given-names></name><name><surname>Kloetzel</surname><given-names>P.-M.</given-names></name><etal/></person-group><article-title>IFN-&#x003b3;-induced immune adaptation of the proteasome system is an accelerated and transient response</article-title><source>Proc. Natl. Acad. Sci. U S A</source><volume>102</volume><year>2005</year><fpage>9241</fpage><lpage>9246</lpage><pub-id pub-id-type=\"pmid\">15944226</pub-id></element-citation></ref><ref id=\"bib24\"><label>24</label><element-citation publication-type=\"journal\" id=\"sref24\"><person-group person-group-type=\"author\"><name><surname>Yu</surname><given-names>G.</given-names></name><name><surname>Wang</surname><given-names>L.-G.</given-names></name><name><surname>Yan</surname><given-names>G.-R.</given-names></name><etal/></person-group><article-title>DOSE: an R/Bioconductor package for disease ontology semantic and enrichment analysis</article-title><source>Bioinformatics</source><volume>31</volume><year>2015</year><fpage>608</fpage><lpage>609</lpage><pub-id pub-id-type=\"pmid\">25677125</pub-id></element-citation></ref><ref id=\"bib25\"><label>25</label><element-citation publication-type=\"journal\" id=\"sref25\"><person-group person-group-type=\"author\"><name><surname>Yu</surname><given-names>G.</given-names></name><name><surname>He</surname><given-names>Q.-Y.</given-names></name></person-group><article-title>ReactomePA: an R/Bioconductor package for reactome pathway analysis and visualization</article-title><source>Mol. Biosyst.</source><volume>12</volume><year>2016</year><fpage>477</fpage><lpage>479</lpage><pub-id pub-id-type=\"pmid\">26661513</pub-id></element-citation></ref><ref id=\"bib26\"><label>26</label><element-citation publication-type=\"journal\" id=\"sref26\"><person-group person-group-type=\"author\"><name><surname>Yu</surname><given-names>G.</given-names></name></person-group><article-title>Using meshes for MeSH term enrichment and semantic analyses</article-title><source>Bioinformatics</source><volume>34</volume><year>2018</year><fpage>3766</fpage><lpage>3767</lpage><pub-id pub-id-type=\"pmid\">29790928</pub-id></element-citation></ref><ref id=\"bib27\"><label>27</label><element-citation publication-type=\"journal\" id=\"sref27\"><person-group person-group-type=\"author\"><name><surname>Martens</surname><given-names>M.</given-names></name><name><surname>Ammar</surname><given-names>A.</given-names></name><name><surname>Riutta</surname><given-names>A.</given-names></name><etal/></person-group><article-title>WikiPathways: connecting communities</article-title><source>Nucleic Acids Res.</source><volume>49</volume><year>2021</year><fpage>D613</fpage><lpage>D621</lpage><pub-id pub-id-type=\"pmid\">33211851</pub-id></element-citation></ref><ref id=\"bib28\"><label>28</label><element-citation publication-type=\"journal\" id=\"sref28\"><person-group person-group-type=\"author\"><name><surname>Conesa</surname><given-names>A.</given-names></name><name><surname>G&#x000f6;tz</surname><given-names>S.</given-names></name><name><surname>Garc&#x000ed;a-G&#x000f3;mez</surname><given-names>J.M.</given-names></name><etal/></person-group><article-title>Blast2GO: a universal tool for&#x000a0;annotation, visualization and analysis in functional genomics research</article-title><source>Bioinformatics</source><volume>21</volume><year>2005</year><fpage>3674</fpage><lpage>3676</lpage><pub-id pub-id-type=\"pmid\">16081474</pub-id></element-citation></ref><ref id=\"bib29\"><label>29</label><element-citation publication-type=\"journal\" id=\"sref29\"><person-group person-group-type=\"author\"><name><surname>Moriya</surname><given-names>Y.</given-names></name><name><surname>Itoh</surname><given-names>M.</given-names></name><name><surname>Okuda</surname><given-names>S.</given-names></name><etal/></person-group><article-title>KAAS: an automatic genome annotation and pathway reconstruction server</article-title><source>Nucleic Acids Res.</source><volume>35</volume><year>2007</year><fpage>W182</fpage><lpage>W185</lpage><pub-id pub-id-type=\"pmid\">17526522</pub-id></element-citation></ref><ref id=\"bib30\"><label>30</label><element-citation publication-type=\"journal\" id=\"sref30\"><person-group person-group-type=\"author\"><name><surname>Zhang</surname><given-names>X.</given-names></name><name><surname>Lan</surname><given-names>Y.</given-names></name><name><surname>Xu</surname><given-names>J.</given-names></name><etal/></person-group><article-title>CellMarker: a manually curated resource of cell markers in human and mouse</article-title><source>Nucleic Acids Res.</source><volume>47</volume><year>2019</year><fpage>D721</fpage><lpage>D728</lpage><pub-id pub-id-type=\"pmid\">30289549</pub-id></element-citation></ref><ref id=\"bib31\"><label>31</label><element-citation publication-type=\"journal\" id=\"sref31\"><person-group person-group-type=\"author\"><name><surname>McLean</surname><given-names>C.Y.</given-names></name><name><surname>Bristor</surname><given-names>D.</given-names></name><name><surname>Hiller</surname><given-names>M.</given-names></name><etal/></person-group><article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title><source>Nat. Biotechnol.</source><volume>28</volume><year>2010</year><fpage>495</fpage><lpage>501</lpage><pub-id pub-id-type=\"pmid\">20436461</pub-id></element-citation></ref><ref id=\"bib32\"><label>32</label><element-citation publication-type=\"journal\" id=\"sref32\"><person-group person-group-type=\"author\"><name><surname>Liu</surname><given-names>Y.</given-names></name><name><surname>Fu</surname><given-names>L.</given-names></name><name><surname>Kaufmann</surname><given-names>K.</given-names></name><etal/></person-group><article-title>A practical guide for DNase-seq data analysis: from data management to common applications</article-title><source>Brief. Bioinform</source><volume>20</volume><year>2019</year><fpage>1865</fpage><lpage>1877</lpage><pub-id pub-id-type=\"pmid\">30010713</pub-id></element-citation></ref><ref id=\"bib33\"><label>33</label><element-citation publication-type=\"journal\" id=\"sref33\"><person-group person-group-type=\"author\"><name><surname>Yin</surname><given-names>S.</given-names></name><name><surname>Lu</surname><given-names>K.</given-names></name><name><surname>Tan</surname><given-names>T.</given-names></name><etal/></person-group><article-title>Transcriptomic and open chromatin atlas of high-resolution anatomical regions in the rhesus macaque brain</article-title><source>Nat. Commun.</source><volume>11</volume><year>2020</year><fpage>474</fpage><pub-id pub-id-type=\"pmid\">31980617</pub-id></element-citation></ref><ref id=\"bib34\"><label>34</label><element-citation publication-type=\"journal\" id=\"sref34\"><person-group person-group-type=\"author\"><name><surname>Oliviero</surname><given-names>G.</given-names></name><name><surname>Munawar</surname><given-names>N.</given-names></name><name><surname>Watson</surname><given-names>A.</given-names></name><etal/></person-group><article-title>The variant Polycomb Repressor Complex 1 component PCGF1 interacts with a pluripotency sub-network that includes DPPA4, a regulator of embryogenesis</article-title><source>Sci. Rep.</source><volume>5</volume><year>2015</year><fpage>18388</fpage><pub-id pub-id-type=\"pmid\">26687479</pub-id></element-citation></ref><ref id=\"bib35\"><label>35</label><element-citation publication-type=\"journal\" id=\"sref35\"><person-group person-group-type=\"author\"><name><surname>Cheng</surname><given-names>B.</given-names></name><name><surname>Ren</surname><given-names>X.</given-names></name><name><surname>Kerppola</surname><given-names>T.K.</given-names></name></person-group><article-title>KAP1 represses differentiation-inducible genes in embryonic stem cells through cooperative binding with PRC1 and derepresses pluripotency-associated genes</article-title><source>Mol. Cell. Biol.</source><volume>34</volume><year>2014</year><fpage>2075</fpage><lpage>2091</lpage><pub-id pub-id-type=\"pmid\">24687849</pub-id></element-citation></ref><ref id=\"bib36\"><label>36</label><element-citation publication-type=\"journal\" id=\"sref36\"><person-group person-group-type=\"author\"><name><surname>Santanach</surname><given-names>A.</given-names></name><name><surname>Blanco</surname><given-names>E.</given-names></name><name><surname>Jiang</surname><given-names>H.</given-names></name><etal/></person-group><article-title>The Polycomb group protein CBX6 is an essential regulator of embryonic stem cell identity</article-title><source>Nat. Commun.</source><volume>8</volume><year>2017</year><fpage>1235</fpage><pub-id pub-id-type=\"pmid\">29089522</pub-id></element-citation></ref><ref id=\"bib37\"><label>37</label><element-citation publication-type=\"journal\" id=\"sref37\"><person-group person-group-type=\"author\"><name><surname>Deng</surname><given-names>H.</given-names></name><name><surname>Guan</surname><given-names>X.</given-names></name><name><surname>Gong</surname><given-names>L.</given-names></name><etal/></person-group><article-title>CBX6 is negatively regulated by EZH2 and plays a potential tumor suppressor role in breast cancer</article-title><source>Sci. Rep.</source><volume>9</volume><year>2019</year><fpage>197</fpage><pub-id pub-id-type=\"pmid\">30655550</pub-id></element-citation></ref><ref id=\"bib38\"><label>38</label><element-citation publication-type=\"journal\" id=\"sref38\"><person-group person-group-type=\"author\"><name><surname>Brun</surname><given-names>Y.F.</given-names></name><name><surname>Varma</surname><given-names>R.</given-names></name><name><surname>Hector</surname><given-names>S.M.</given-names></name><etal/></person-group><article-title>Simultaneous modeling of concentration-effect and time-course patterns in gene expression data from microarrays</article-title><source>Cancer Genomics Proteomics</source><volume>5</volume><year>2008</year><fpage>43</fpage><lpage>53</lpage><pub-id pub-id-type=\"pmid\">18359979</pub-id></element-citation></ref><ref id=\"bib39\"><label>39</label><element-citation publication-type=\"journal\" id=\"sref39\"><person-group person-group-type=\"author\"><name><surname>Korotkevich</surname><given-names>G.</given-names></name><name><surname>Sukhov</surname><given-names>V.</given-names></name><name><surname>Budin</surname><given-names>N.</given-names></name><etal/></person-group><article-title>Fast gene set enrichment analysis</article-title><source>bioRxiv</source><year>2021</year><pub-id pub-id-type=\"doi\">10.1101/060012</pub-id></element-citation></ref><ref id=\"bib40\"><label>40</label><element-citation publication-type=\"journal\" id=\"sref40\"><person-group person-group-type=\"author\"><name><surname>Wimalanathan</surname><given-names>K.</given-names></name><name><surname>Lawrence-Dill</surname><given-names>C.J.</given-names></name></person-group><article-title>Gene ontology Meta annotator for plants (GOMAP)</article-title><source>bioRxiv</source><year>2021</year><pub-id pub-id-type=\"doi\">10.1101/809988</pub-id></element-citation></ref><ref id=\"bib41\"><label>41</label><element-citation publication-type=\"journal\" id=\"sref41\"><person-group person-group-type=\"author\"><name><surname>Collado-Torres</surname><given-names>L.</given-names></name><name><surname>Nellore</surname><given-names>A.</given-names></name><name><surname>Jaffe</surname><given-names>A.E.</given-names></name></person-group><article-title>Recount workflow: accessing over 70,000 human RNA-seq samples with Bioconductor</article-title><source>F1000Research.</source><volume>6</volume><year>2017</year><fpage>1558</fpage><pub-id pub-id-type=\"pmid\">29043067</pub-id></element-citation></ref><ref id=\"bib42\"><label>42</label><element-citation publication-type=\"journal\" id=\"sref42\"><person-group person-group-type=\"author\"><name><surname>Chao</surname><given-names>K.-H.</given-names></name><name><surname>Hsiao</surname><given-names>Y.-W.</given-names></name><name><surname>Lee</surname><given-names>Y.-F.</given-names></name><etal/></person-group><article-title>RNASeqR: an R package for automated two-group RNA-Seq analysis workflow</article-title><source>IEEE/ACM Trans. Comput. Biol. Bioinform.</source><year>2019</year><pub-id pub-id-type=\"doi\">10.1109/TCBB.2019.2956708</pub-id></element-citation></ref><ref id=\"bib43\"><label>43</label><element-citation publication-type=\"journal\" id=\"sref43\"><person-group person-group-type=\"author\"><name><surname>Wang</surname><given-names>B.</given-names></name><name><surname>Wang</surname><given-names>M.</given-names></name><name><surname>Zhang</surname><given-names>W.</given-names></name><etal/></person-group><article-title>Integrative analysis of pooled CRISPR genetic screens using MAGeCKFlute</article-title><source>Nat. Protoc.</source><volume>14</volume><year>2019</year><fpage>756</fpage><lpage>780</lpage><pub-id pub-id-type=\"pmid\">30710114</pub-id></element-citation></ref></ref-list><sec id=\"appsec1\"><title>Lead contact website</title><p id=\"p0160\"><ext-link ext-link-type=\"uri\" xlink:href=\"https://yulab-smu.top/\" id=\"intref0055\">https://yulab-smu.top</ext-link>.</p></sec><sec id=\"appsec3\" sec-type=\"supplementary-material\"><title>Supplemental information</title><p id=\"p0170\">\n<supplementary-material content-type=\"local-data\" id=\"mmc1\"><caption><title>Document S1. Note S1 and Tables S1 and S2</title></caption><media xlink:href=\"mmc1.pdf\"/></supplementary-material>\n<supplementary-material content-type=\"local-data\" id=\"mmc2\"><caption><title>Document S2. Article plus supplemental information</title></caption><media xlink:href=\"mmc2.pdf\"/></supplementary-material>\n</p></sec><ack id=\"ack0010\"><title>Acknowledgments</title><p id=\"p0145\">This work was supported by a startup fund from <funding-source id=\"gs1\"><institution-wrap><institution-id institution-id-type=\"doi\">10.13039/501100010096</institution-id><institution>Southern Medical University</institution></institution-wrap></funding-source>.</p><sec id=\"sec4\"><title>Author contributions</title><p id=\"p0150\">G.Y. and X.B. planned the study, analyzed and interpreted the data, and drafted the manuscript. T.W. and E.H. analyzed and interpreted the data, and revised the manuscript. S.X., M.C., and P.G. were responsible for data collection and data analysis, and revised the manuscript. Z.D., T.F., and L.Z. contributed to data analysis and interpretation. W.T., L.Z., X.F., and S.L. participated in data analysis and manuscript revision. All authors have given final approval for the manuscript to be published and have agreed to be responsible for all aspects of the manuscript.</p></sec><sec sec-type=\"COI-statement\" id=\"sec5\"><title>Declaration of interests</title><p id=\"p0155\">The authors declare no competing interests.</p></sec></ack><fn-group><fn id=\"appsec2\" fn-type=\"supplementary-material\"><p id=\"p0165\">Supplemental information can be found online at <ext-link ext-link-type=\"uri\" xlink:href=\"https://doi.org/10.1016/j.xinn.2021.100141\" id=\"intref0060\">https://doi.org/10.1016/j.xinn.2021.100141</ext-link>.</p></fn></fn-group></back></article>",
  "plain_text": "Introduction Functional enrichment analysis is one of the most widely used techniques for interpreting gene lists or genome-wide regions of interest (ROIs) 1 derived from various high-throughput studies. Although many tools have been developed for gene-centric or epigenomic enrichment analysis, most are designed for model organisms or specific domains (e.g., fungi, 2 plants 3 ) embedded with particular annotations such as Gene Ontology (GO) and the Kyoto Encyclopedia of Genes and Genomes (KEGG). 4 Non-model organisms and functional annotations other than GO and KEGG are poorly supported. Moreover, the increasing concerns for the quality of gene annotation have raised an alarm in biomedical research. Because annotation databases have diverse or irregular update periods, many tools may fail to update the corresponding information in time. A previous study 5 reported that about 42% of the tools were outdated by more than 5 years and that functional significance was severely underestimated, with only 26% of biological processes or pathways captured in comparison with those employing up-to-date annotation. Such negative impacts of outdated annotation can be propagated for years and can hinder follow-up studies. Reanalyzing the GTEx dataset 6 published by the ENCODE consortium using clusterProfiler uncovered a large number of new pathways, which were missed in the analysis using out-of-date annotation ( https://github.com/GuangchuangYu/enrichment4GTEx_clusterProfiler ), and new hypotheses were generated based on these new pathways. The clusterProfiler library was first published in 2012 7 and designed to perform over-representation analysis (ORA) 8 using GO and KEGG for several model organisms and to compare functional profiles of various conditions on one level (e.g., different treatment groups). Since then, clusterProfiler has matured substantially and currently supports several ontology and pathway annotations, thousands of species with up-to-date gene annotation, users annotation data for novel species, and emerging new annotations. Both ORA and gene set enrichment analysis (GSEA) 9 are supported. The comparison utility is extended to support a complex experimental design that allows comparison of functional profiles of various conditions on different levels. The clusterProfiler library has many unique features, including a tidy interface that can manipulate the enrichment result and directly support the visualization of the enrichment result using ggplot2 ( Tables 1 and S2 ). Moreover, we have developed several packages to complement its functionalities, including ChIPseeker to connect functional analysis with genomic ROIs, 10 GOSemSim 11 to remove redundant GO terms, and enrichplot to visualize the enrichment results. These complementary packages enable clusterProfiler to stand out among other tools. The clusterProfiler library is one of the most popular Bioconductor packages. It has been incorporated in more than 30 CRAN and Bioconductor packages ( Table S1 ), several pipelines (e.g., The Cancer Genome Atlas [TCGA] Workflow 12 and ViralLink 13 ), and online platforms (e.g., NASQAR 14 and ABioTrans 15 ). Results Gene ontology The clusterProfiler package provides the enrichGO and gseGO functions for ORA and GSEA using GO. 16 Instead of providing species-specific GO annotation, clusterProfiler relies on genome-wide annotation packages (OrgDb) released by the Bioconductor project. There are 20 OrgDb packages available in Bioconductor for different species, such as human, mouse, fly, yeast, and worm. These packages are updated biannually. GO annotation for non-model organisms can be queried online via the AnnotationHub package, which provides web services for accessing genome-wide annotations from various data providers (e.g., UCSC, Ensembl, NCBI, STRING, and GENCODE). With the efforts from the Bioconductor community to maintain up-to-date GO annotation for model and non-model organisms, clusterProfiler supports GO analysis on more species compared with other tools. Moreover, a data frame of GO annotation (e.g., retrieve data from the BiomaRt or UniProt database using taxonomic ID) can be used to construct an OrgDb using the AnnotationForge package or directly through the universal interface for enrichment analysis. GO terms are organized as a directed acyclic graph, in which a directed edge denotes a parent-child semantic relationship. A parent term might be significantly enriched only because it contains all the genes of a significantly over-represented child term. Consequently, the list of enriched GO terms is often too long and contains redundant terms, which hinders effective interpretation. Therefore, clusterProfiler integrates a simplify function to eliminate such redundant GO terms. This function employs the GOSemSim 17 package to calculate semantic similarities among enriched GO terms using multiple methods based on information content or graph structure. Highly similar GO terms (e.g., >0.7) will be removed by applying the simplify function to retain a representative term (e.g., the most significant term). The following example shows an ORA on Biological Process (BP) to identify significant BP terms associated with the differentially expressed genes (DEGs). The geneList dataset, which contains fold change of gene expression levels between breast tumor and normal samples and is provided by the DOSE package, was used in this example. The DEGs were identified by a criterion of fold change >2. As demonstrated in Figure 1 A, the top 30 enriched terms are highly connected, and it seems that the DEGs are associated with a single functional module. Visualizing top enriched terms is a common approach to present and interpret the enrichment result. However, the top results are dominated by a large number of highly similar terms. After removing redundant terms, the result reveals a more global view with several different functional modules ( Figure 1 B). This feature simplifies the enrichment results, assists in interpretation, and avoids the annotation/interpretation bias. 18 library(clusterProfiler) data(geneList, package=\"DOSE\") ## fold change > 2 as DE genes de <- names(geneList)[abs(geneList) > 2] ego <- enrichGO(de, OrgDb = \"org.Hs.eg.db\", ont=\"BP\", readable=TRUE) ## use simplify to remove redundant terms ego2 <- simplify(ego, cutoff=0.7, by=\"p.adjust\", select_fun=min) Kyoto encyclopedia of genes and genomes KEGG is an encyclopedia of genes and genomes. 19 Molecular functions are represented by networks of interactions and reactions mainly in the form of KEGG pathways and modules. A KEGG module is a collection of manually defined function units. In some situations, KEGG modules have a more straightforward interpretation. Both KEGG pathways and KEGG modules are supported by clusterProfiler. Many software tools that support KEGG analysis have stopped updating since July 2011 when KEGG initiated an academic subscription model for FTP downloading. These tools use relatively old KEGG data, and the result might be inaccurate and misleading. Fortunately, the KEGG web resource is freely available. The clusterProfiler package does not pack any KEGG data. Instead, it queries the latest online KEGG database through web API to perform functional analysis. The advantage of this feature is obvious: it allows clusterProfiler to use up-to-date data and support all the species that have KEGG annotation (more than 6,000 species are listed in http://www.genome.jp/kegg/catalog/org_list.html ). Moreover, clusterProfiler supports the KEGG Orthology database and can be used to perform functional characterization of the microbiomes. 20 In the following example, GSEA was performed with KEGG pathway. Figure 2 A shows the plotting of GSEA enrichment results to visualize the top five perturbed pathways, i.e., the top five highest absolute values of the normalized enrichment score (NES). 9 The NES indicates the shift of genes belonging to a certain pathway toward either end of the ranked list and represents pathway activation or suppression. To further explore the pathway crosstalk effects, we visualized gene expression distribution of core enrichment genes using an UpSet plot ( Figure 2 B). The result shows that the expression values of genes in the intersection of cell-cycle and DNA-replication pathways are higher than those uniquely belonging to either of the two pathways. These overlapping genes are mainly minichromosome maintenance (MCM) genes, which can potentially serve as biomarkers for tumor diagnosis. 21 The intersection of the interleukin-17 (IL-17) signaling pathway and the proteasome pathway is only associated with one gene, interferon- (IFN-). The IL-17 signaling pathway induces an inflammatory response, 22 while IFN- regulates proteasome formation. 23 These effects ultimately reshape the tumor microenvironment. kk <- gseKEGG(geneList, organism = \"hsa\") Universal interface for biomedical gene sets With the advancement of the sequencing technology, the investigation into functions for transcriptomes from non-model organisms is increasingly demanded. However, most tools in this field are designed for GO and KEGG analyses with support limited to one or several model organisms. Besides, there are increasingly more biological knowledge databases available for exploring functional characteristics from different perspectives, such as Disease Ontology, 24 Reactome Pathway, 25 Medical Subject Headings, 26 , and WikiPathway. 27 There is an urgent need for integration and support of these databases. To address these issues, clusterProfiler provides two general functions, enricher and GSEA for ORA and GSEA, with user-provided gene annotations. These two functions allow the application of all ontologies or pathways curated in diverse databases as the background in customized analyses. Therefore, users could easily import external annotations (e.g., electronic annotations using Blast2GO 28 and KAAS 29 for GO and KEGG annotations, respectively) for newly sequenced species. Moreover, it is convenient to perform functional analysis using up-to-date annotations from all popular databases, such as InterPro, Clusters of Orthologous Groups, and Mouse Phenotype Ontology, to name a few, without waiting for the updates of other tools. It would be suitable for the timely analysis of gene sets with emerging interests, such as human cell markers 30 and COVID-19-related gene sets. The gene set annotation required by enricher and GSEA is a two-column data frame with one column representing gene set names (ID or descriptive name) and the other showing the corresponding genes. The gene matrix transposed (GMT) format is widely used to distribute gene set annotations. There are many gene set libraries available online (e.g., https://maayanlab.cloud/Enrichr/#stats ), including MSigDB (Molecular Signatures Database), Disease Signatures, and CCLE (Cancer Cell Line Encyclopedia). To enable the utilization of these gene sets in clusterProfiler as the background annotation to explore the underlying biological mechanisms, clusterProfiler provides a parser function, read . gmt , to import GMT files that can be directly passed to the enricher and GSEA functions. In the following example, we used the GSEA function to perform gene set enrichment analysis using WikiPathways ( Figure 5 B). The annotation data were parsed by using read . gmt . wp , which is a customized version of read . gmt for importing GMT files from WikiPathways. ## downloaded from https://wikipathways-data.wmcloud.org/current/gmt/ gmt <- wikipathways-20210310-gmt-Homo_sapiens.gmt wp <- read.gmt.wp (gmt) ewp <- GSEA (geneList, TERM2GENE=wp[, c (\"wpid\", \"gene\")], TERM2NAME=wp[, c (\"wpid\", \"name\")]) Functional interpretation of genomic ROIs With the increasing availability of genomic sequences, non-coding genomic regions (e.g., cis -regulatory elements, non-coding RNAs, and transposons) have posed a demanding challenge to exploration of their roles in various biological processes. 1 Unlike coding genes, non-coding genomic regions are typically not well functionally annotated. Analyzing biological functions of the proximal genes is a common strategy in research on the biological meaning of a set of non-coding genomic regions. Software tools, such as the Genomic Regions Enrichment of Annotations Tool (GREAT), 31 are implemented to follow this strategy. However, these tools only support a limited number of species. For example, GREAT is designed for human and mouse only. In addition, many tools only take the host or nearest genes into consideration but ignore long-distance regulations. Our in-house developed package, ChIPseeker, 10 is originally designed for chromatin immunoprecipitation (ChIP) peak annotation, comparison, and visualization and has been employed to analyze genome-wide ROIs, such as open chromatin regions obtained by DNase-seq 32 and ATAC-seq. 33 To facilitate biological interpretation of genome-wide regions, we implemented a function, seq2gene , in ChIPseeker to associate genomic regions with coding genes through many-to-many mapping. It automatically maps genomic regions to host genes (either located in exon or intron), proximal genes (located in the promoter region), and flanking genes (located upstream and downstream within user-specified distance). The seq2gene function supports a wide variety of species if a genomic annotation, such as the TxDb (UCSC-based) or EnsDb (Ensembl-based) object, is available. After mapping genomic regions to coding genes, clusterProfiler can be employed to perform functional enrichment analysis of the coding genes to assign biological meanings to the set of genomic regions. The combination of ChIPseeker and clusterProfiler allows more biological ontology or pathway databases to be utilized to explore functions of genomic regions for a wide variety of species. library(ChIPseeker) ## the file can be downloaded using downloadGSMbedFiles(\"GSM1295076\") file <- \"GSM1295076_CBX6_BF_ChipSeq_mergedReps_peaks.bed.gz\" gr <- readPeakFile(file) library(TxDb.Hsapiens.UCSC.hg19.knownGene) TxDb <- TxDb.Hsapiens.UCSC.hg19.knownGene genes <- seq2gene(gr, tssRegion=c(-1000, 1000), flankDistance = 3000, TxDb) library(clusterProfiler) g <- bitr(genes, ENTREZID, SYMBOL, org.Hs.eg.db) ## downloaded from https://maayanlab.cloud/Enrichr/geneSetLibrary?mode=text&libraryName=ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X encode <- read.gmt(\"ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X.txt\") enricher(g$SYMBOL, TERM2GENE=encode) A dataset of ChIP-seq with antibody against CBX6 (GEO: GSM1295076 ) was used in the above example. The genomic binding regions were mapped to coding genes using the seq2gene function with UCSC genomic annotation. The Entrez gene IDs were converted into gene symbols using the bitr function implemented in clusterProfiler. To identify and characterize transcript cofactors, we performed functional enrichment analysis using the ENCODE and ChEA transcript factor gene sets. The result was visualized as a category-gene network ( Figure 3 ), which showed that genes associated with CBX6 (obtained by the seq2gene function) significantly overlap with genes regulated by POU5F1, TRIM28, SUZ12, and EZH2. OCT4 (POU5F1) 34 and KAP1 (TRIM28) 35 have been reported to interact with polycomb repressive complex 1 (PRC1), and CBX6 is a known subunit of PRC1. 36 SUZ12 and EZH2 are core components of PRC2 and negatively regulate CBX6. 37 These pieces of evidence support the effectiveness of these analyses including the mapping of genomic ROIs to coding genes and functional enrichment, which suggest that this method can be used to identify unknown cofactors ( Figure 3 ) and characterize functions of genomic regions. Comparison among different conditions The clusterProfiler library is designed to allow the comparison of functional enrichment results from multiple experimental conditions or multiple time points. With an input of a collection of gene lists, the compareCluster function applies a function (e.g., enricher ) with user settings to perform functional enrichment analysis for each of the gene lists and aggregates the results into a single object. Thus, enrichment results of multiple groups are easily explored and plotted together for comparison with a user-friendly interface. Comparing functional profiles can reveal functional consensus and differences among different experiments and helps in identifying differential functional modules in omics datasets. In the updated version, compareCluster provides a new interface supporting a formula that is widely used in R for specifying statistical models; this allows more complicated experimental designs to be supported (e.g., time-course experiment with different treatments). With the infrastructure of clusterProfiler to support a wide range of ontology and pathway annotations and multiple organisms, the comparison can be applied to many circumstances. The dataset, DE_GSE8057, was derived from the GEO: GSE8057 dataset in the GEO database. The GSE8057 dataset contains expression data from ovarian cancer cells at multiple time points (0, 2, 6, and 24 h) and under two treatment conditions (cisplatin and oxaliplatin). 38 The DE_GSE8057 dataset contains DEGs obtained from different treatments and time points versus control samples. Eight groups of DEG lists (specified by the formula Gene ~ Time + Treatment ) were analyzed simultaneously using compareCluster with WikiPathways. The result ( Figure 4 ) indicates that the two drugs have distinct effects at the beginning but consistent effects in the later stages. Several pathways including DNA damage and cell-cycle progression were perturbed by either cisplatin or oxaliplatin drug exposure. The finding is consistent with the discovery obtained by data-driven modeling. 38 data(DE_GSE8057) xx <- compareCluster(Genetime+treatment, data=DE_GSE8057, fun = enricher, TERM2GENE=wp[,c(\"wpid\", \"gene\")], TERM2NAME=wp[,c(\"wpid\", \"name\")]) Data frame interface for accessing enriched results The outputs of ORA and GSEA are enrichResult and gseaResult objects, respectively, while the output of compareCluster is a compareClusterResult object. These S4 objects contain input data, analysis settings, and enriched results, which allow more informative data to be available for downstream interpretation and visualization. To enable easy access to the enriched result, clusterProfiler implements as . data . frame methods to convert the S4 objects to data frames that can be easily exported as CSV files. In addition, clusterProfiler provides a data frame interface that mimics data frame operations to access rows, columns, and subsets of rows and columns from the S4 objects of the enriched result. Users can use head and tail to print part of the result. The nrow , ncol , and dim methods are also supported to access basic information such as how many pathways are enriched. ## head or tail to print first or last n rows head (ego, 2) ## ID Description GeneRatio BgRatio pvalue ## GO:0140014 GO:0140014 mitotic nuclear division 34/194 286/18866 2.171838e-26 ## GO:0000280 GO:0000280 nuclear division 36/194 428/18866 1.099719e-22 ## p.adjust qvalue ## GO:0140014 6.700119e-23 5.710790e-23 ## GO:0000280 1.696316e-19 1.445841e-19 ## geneID ## GO:0140014 CDCA8/CDC20/KIF23/CENPE/MYBL2/CCNB2/NDC80/NCAPH/DLGAP5/UBE2C/NUSAP1/TPX2/TACC3/NEK2/UBE2S/CDK1/MAD2L1/KIF18A/CDT1/BIRC5/KIF11/TTK/NCAPG/AURKB/CHEK1/TRIP13/PRC1/KIFC1/KIF18B/AURKA/CCNB1/KIF4A/PTTG1/BMP4 ## GO:0000280 CDCA8/CDC20/KIF23/CENPE/MYBL2/CCNB2/NDC80/TOP2A/NCAPH/ASPM/DLGAP5/UBE2C/NUSAP1/TPX2/TACC3/NEK2/UBE2S/CDK1/MAD2L1/KIF18A/CDT1/BIRC5/KIF11/TTK/NCAPG/AURKB/CHEK1/TRIP13/PRC1/KIFC1/KIF18B/AURKA/CCNB1/KIF4A/PTTG1/BMP4 ## Count ## GO:0140014 34 ## GO:0000280 36 The [ and $ operators for subsetting are also supported. We redefined the [[ operator to help users access which genes are annotated by a selected ontology or pathway. For GSEA output, the [[ operator will return core enriched genes (i.e., genes in the leading edge) of the selected gene set. ## subset result using [ and $ ego[1:2, c (\"ID\", \"Description\", \"pvalue\", \"p.adjust\")] ## ID Description pvalue p.adjust ## GO:0140014 GO:0140014 mitotic nuclear division 2.171838e-26 6.700119e-23 ## GO:0000280 GO:0000280 nuclear division 1.099719e-22 1.696316e-19 head (ego $ Description) ## [1] \"mitotic nuclear division\" ## [2] \"nuclear division\" ## [3] \"organelle fission\" ## [4] \"mitotic sister chromatid segregation\" ## [5] \"sister chromatid segregation\" ## [6] \"chromosome segregation\" ## genes annotated by specific term ego[[\"GO:0140014\"]] ## [1] \"CDCA8\" \"CDC20\" \"KIF23\" \"CENPE\" \"MYBL2\" \"CCNB2\" \"NDC80\" \"NCAPH\" ## [9] \"DLGAP5\" \"UBE2C\" \"NUSAP1\" \"TPX2\" \"TACC3\" \"NEK2\" \"UBE2S\" \"CDK1\" ## [17] \"MAD2L1\" \"KIF18A\" \"CDT1\" \"BIRC5\" \"KIF11\" \"TTK\" \"NCAPG\" \"AURKB\" ## [25] \"CHEK1\" \"TRIP13\" \"PRC1\" \"KIFC1\" \"KIF18B\" \"AURKA\" \"CCNB1\" \"KIF4A\" ## [33] \"PTTG1\" \"BMP4\" Tidy interface for data operation To facilitate data manipulation and exploration of the enrichment result, clusterProfiler extends the dplyr verbs to support enrichResult , gseaResult , and compareClusterResult objects. Following the concept of tidiness, these verbs provide robust and standardized operations for data transformation and can be assembled into a workflow using the pipe operator (%>%). This allows users to explore the results effectively and develop reproducible and human-readable pipelines. For example, it allows the filtering of enriched results using different criteria (e.g., adjusted p values less than 0.001, and the number of input genes annotated to the enriched term should be greater than 10). dim (ego) ## [1] 197 9 ego2 <- filter (ego, p.adjust < 0.001, Count > 10) dim (ego2) ## [1] 44 9 For ORA results, clusterProfiler provides geneRatio (ratio of input genes that are annotated in a term) and BgRatio (ratio of all genes that are annotated in this term). However, other concepts are widely used to help in interpreting enrichment results, such as the rich factor and fold enrichment. A rich factor is defined as the ratio of input genes (e.g., DEGs) that are annotated in a term to all genes that are annotated in this term. The fold enrichment is defined as the ratio of the frequency of input genes annotated in a term to the frequency of all genes annotated to that term, and it is easy to calculate by dividing geneRatio by BgRatio . Here, as an example, we used the mutate verb to create a new column of richFactor based on information available in the clusterProfiler output. ego3 <- mutate (ego, richFactor = Count / as.numeric ( sub (\"/\\\\d+\", \"\", BgRatio))) The following example uses the GSEA enrichment result generated in the previous session. The result was sorted by absolute values of NESs using the arrange verb. NES is an indicator to interpret the degree of enrichment. A positive NES indicates that members of the gene set tend to appear at the top of the rank (pathway activation), and a negative NES indicates the opposite circumstance (pathway suppression). We used the group_by verb to group the result based on the sign of NES, and the slice verb was used to extract the first five enriched pathways for each group (i.e., five activated pathways that have the largest NES values and five suppressed pathways that have the smallest NES values). These verbs return the same object type as their input and do not affect downstream analysis and visualization. ewp2 <- arrange (ewp, desc ( abs (NES))) %>% group_by ( sign (NES)) %>% slice (1:5) Visualization using Ggplot2 The enrichplot package is originally derived from DOSE and clusterProfiler packages and serves as a de facto visualization tool for visualizing enrichment results for outputs from clusterProfiler as well as DOSE, ReactomePA, and meshes. These methods allow users without programming skills to generate effective visualization to explore and interpret results. All the visualization methods implemented are based on ggplot2 , which allows customization using the grammar of graphics. Moreover, we also extend ggplot2 to support enrichment results so that users can use the ggplot2 syntax directly to visualize enrichment results. The following example demonstrates the application of ggplot2 grammar of graphics to visualize the GO enrichment result (ORA) as a lollipop chart using the rich factor that was generated in the previous session using the dplyr verbs ( Figure 5 A). library(ggplot2) library(forcats) ggplot(ego3, showCategory = 10, aes(richFactor, fct_reorder(Description, richFactor))) + geom_segment(aes(xend=0, yend = Description)) + geom_point(aes(color=p.adjust, size = Count)) + scale_color_gradientn(colours=c(\"#f7ca64\", \"#46bac2\", \"#7e62a3\"), trans = \"log10\", guide=guide_colorbar(reverse=TRUE, order=1)) + scale_size_continuous(range=c(2, 10)) + theme_dose(12) + xlab(\"Rich Factor\") + lab(NULL) + ggtitle(\"Biological Processes\") In Figure 5 B, the most significant activated and suppressed pathways (GSEA) selected by a series of dplyr verb operations are visualized as a bar chart using the ggplot2 syntax. Although visualization methods used to generate Figure 5 are not provided in clusterProfiler, it is easy to generate such graphs using the tidy interface and ggplot2 . The combination of the tidy interface for data wrangling and the support of ggplot2 for visualization creates many possibilities for users to explore and visualize enrichment results using consistent grammar. It allows novel exploratory approaches to reveal unanticipated mechanisms as well as prototyping new visualization methods. ggplot(ewp2, showCategory=10, aes(NES, fct_reorder(Description, NES), fill=qvalues)) + geom_col() + scale_fill_gradientn(colours=c(\"#b3eebe\", \"#46bac2\", \"#371ea3\"), guide=guide_colorbar(reverse=TRUE)) + theme_dose(12) + xlab(\"Normalized Enrichment Score\") + ylab(NULL) + ggtitle(\"WikiPathways\") Package interoperability The clusterProfiler package is a versatile tool for enrichment analysis. It is developed within the Bioconductor ecosystem and has become an essential part of this ecosystem. Currently there are more than 30 R packages that rely on clusterProfiler to perform functional analysis for different topics, especially for cancer research. GO analysis relies on GO annotation maintained by the community, and the enrichment analysis for genomic regions relies on genomic annotation maintained by UCSC and Ensembl. There are R packages that contain gene set annotation (e.g., msigdbr) and R client libraries for accessing pathway data (e.g., rWikiPathways). These data can be used directly as background annotation in clusterProfiler through the universal interface to characterize the functional profile of omics data. The ORA algorithm is implemented in the DOSE package 21 developed in-house, and the GSEA algorithm is implemented in DOSE and fgsea 39 packages. Our team has developed several packages to complement the functionality of clusterProfiler. ChIPseeker 10 bridges the genomic region with functional enrichment by annotating the genomic region to associated genes. GOSemSim 11 provides more than five methods for measuring semantic similarity. It allows removal of redundant terms using semantic similarities among GO terms and allows enrichment results to be visualized in semantic space so that similar terms cluster together. The DOSE 24 package supports functional enrichment from the disease perspective, including disease ontology, the network of cancer genes, and disease gene network. The ReactomePA 25 and meshes 26 packages support functional analysis using Reactome Pathways and Medical Subject Headings, respectively. DOSE, ReactomePA, and meshes are developed within the framework of clusterProfiler, and the enrichment analysis functions provided in these packages can be used in compareCluster for the comparison of functional profiles under various conditions and at different time points. The enrichplot package provides several visualization methods to generate publication-quality figures to help users interpret the results ( Figures 1 , 2 , 3 , and 4 ; supplemental information ). This package suite provides a comprehensive set of tools for mining biological knowledge to elucidate and interpret molecular mechanisms ( Figure 6 ). Discussion and conclusions Pathway enrichment analysis is an essential step toward identifying biological themes that are most characteristic of high-throughput sequencing data. The clusterProfiler library provides a set of functions to unveil biological functions and pathways. Compared with many other tools that do not update background annotation databases in timely fashion and only support a limited number of organisms, clusterProfiler uses up-to-date biological knowledge of genes and biological processes (GO and KEGG) and supports thousands of organisms. In addition, clusterProfiler provides a universal interface for functional analysis with user-provided annotations. This creates the possibility to apply clusterProfiler on functional characterization of different types of data with different biological knowledge. The tidy interface provided in clusterProfiler harmonizes data structures and workflows and makes it easier for the community to develop modular manipulation, visualization, and analysis methods to supplement the existing ecosystem. clusterProfiler has already been integrated into more than 30 packages to perform functional analysis on data obtained using different techniques, including ATAC-seq, multi-region sequencing (MRS), CRISPR/Cas9 screens, and mass spectrometry ( Table S1 ). The clusterProfiler package can be easily integrated into analysis pipelines. For example, the Gene Ontology Meta Annotator for Plants (GOMAP) is optimized for GO annotation of large, repetitive plant genomes. 40 Users can develop a pipeline to combine GOMAP with clusterProfiler to characterize the functionality of sequencing data from plant species, including wheat, maize, soy, and rice. The clusterProfiler library has been incorporated into different pipelines, such as TCGA Workflow, 12 recount workflow, 41 RNASeqR, 42 and MAGeCKFlute. 43 clusterProfiler 4.0 contains several new features, including the tidy interface and the compatibility of using ggplot2 for visualization. There is no API change for functional enrichment analyses, and this version is fully compatible with downstream packages ( Table S1 ). After long-term maintenance, clusterProfiler is mature and unlikely to introduce significant API changes in future development. In the event of an API change, we will maintain backward compatibility for at least 1 year and provide a warning message about the change. The clusterProfiler library is freely available at https://www.bioconductor.org/packages/clusterProfiler . The development version of clusterProfiler is hosted on GitHub ( https://github.com/YuLab-SMU/clusterProfiler ), with many active users. A complete reference of the package suite ( Figure 6 ) is available in the online book, https://yulab-smu.top/biomedical-knowledge-mining-book/ , with many examples and detailed explanations on biological knowledge mining. Source codes to reproduce Figures 1 , 2 , 3 , 4 , and 5 , as well as detailed information about the datasets used in the examples, are available in supplemental information . The clusterProfiler library is one of the popular tools used in functional enrichment analysis (more than 2,500 citations in 2020 according to Google Scholar), and we anticipate that clusterProfiler will continue to be a valuable resource to support the discovery of mechanistic insights and improve our understanding of health and disease.",
  "source_url": "https://europepmc.org/article/pmcid/PMC8454663"
}